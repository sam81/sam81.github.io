<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A R Guide</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A guide for the R programming language.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="A R Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide for the R programming language." />
  <meta name="github-repo" content="sam81/rguide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A R Guide" />
  
  <meta name="twitter:description" content="A guide for the R programming language." />
  

<meta name="author" content="Samuele Carcagno">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="plotly.html">
<link rel="next" href="probability-distribution-functions.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.16.3/plotly-latest.min.js"></script>
<script src="libs/plotly-binding-4.5.6/plotly.js"></script>


<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./preface.html">A R Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#installing-the-base-program"><i class="fa fa-check"></i><b>1.1</b> Installing the Base Program</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices"><i class="fa fa-check"></i><b>1.1.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#windows"><i class="fa fa-check"></i><b>1.1.2</b> Windows</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#mac-os-x"><i class="fa fa-check"></i><b>1.1.3</b> Mac Os X</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installing-add-on-packages"><i class="fa fa-check"></i><b>1.2</b> Installing Add-On Packages</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices-1"><i class="fa fa-check"></i><b>1.2.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#windows-1"><i class="fa fa-check"></i><b>1.2.2</b> Windows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> A Simple Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#datasets"><i class="fa fa-check"></i><b>2.1</b> Datasets</a></li>
<li class="chapter" data-level="2.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#firing-up-and-quitting-r"><i class="fa fa-check"></i><b>2.2</b> Firing up and Quitting R</a></li>
<li class="chapter" data-level="2.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#starting-to-work-with-r"><i class="fa fa-check"></i><b>2.3</b> Starting to Work with R</a></li>
<li class="chapter" data-level="2.4" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.4</b> Getting Help</a><ul>
<li class="chapter" data-level="2.4.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-online-help-system"><i class="fa fa-check"></i><b>2.4.1</b> The Online Help System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#gui"><i class="fa fa-check"></i><b>2.5</b> Working with a Graphical User Interface</a><ul>
<li class="chapter" data-level="2.5.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#r-studio"><i class="fa fa-check"></i><b>2.5.1</b> R Studio</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-r-commander"><i class="fa fa-check"></i><b>2.5.2</b> The R Commander</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#jgr"><i class="fa fa-check"></i><b>2.5.3</b> JGR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html"><i class="fa fa-check"></i><b>3</b> Organising a Working Session</a><ul>
<li class="chapter" data-level="3.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#setting-and-changing-the-working-directory"><i class="fa fa-check"></i><b>3.1</b> Setting and Changing the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#objects"><i class="fa fa-check"></i><b>3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#saving-and-using-the-workspace-image"><i class="fa fa-check"></i><b>3.3</b> Saving and Using the “Workspace Image”</a></li>
<li class="chapter" data-level="3.4" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#working-in-batch-mode"><i class="fa fa-check"></i><b>3.4</b> Working in Batch Mode</a><ul>
<li class="chapter" data-level="3.4.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-an-r-session"><i class="fa fa-check"></i><b>3.4.1</b> Executing commands written in a file from an R session</a></li>
<li class="chapter" data-level="3.4.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-a-shell"><i class="fa fa-check"></i><b>3.4.2</b> Executing commands written in a file from a shell</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Types and Data Manipulation</a><ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#indexing-vectors"><i class="fa fa-check"></i><b>4.2</b> Indexing Vectors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-manip.html"><a href="data-manip.html#the-seq-function"><i class="fa fa-check"></i><b>4.2.1</b> The <code>seq</code> Function</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manip.html"><a href="data-manip.html#the-rep-function"><i class="fa fa-check"></i><b>4.2.2</b> The <code>rep</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-manip.html"><a href="data-manip.html#matrix-facilities"><i class="fa fa-check"></i><b>4.3</b> Matrix Facilities</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-manip.html"><a href="data-manip.html#matrix-operations"><i class="fa fa-check"></i><b>4.3.1</b> Matrix Operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-manip.html"><a href="data-manip.html#Lists"><i class="fa fa-check"></i><b>4.4</b> Lists</a></li>
<li class="chapter" data-level="4.5" data-path="data-manip.html"><a href="data-manip.html#dataframes"><i class="fa fa-check"></i><b>4.5</b> Dataframes</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-manip.html"><a href="data-manip.html#accessing-parts-of-a-dataframe"><i class="fa fa-check"></i><b>4.5.1</b> Accessing Parts of a Dataframe</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-manip.html"><a href="data-manip.html#change-the-names-of-variables-in-a-dataframe"><i class="fa fa-check"></i><b>4.5.2</b> Change the Names of Variables in a Dataframe</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-manip.html"><a href="data-manip.html#other-ways-to-subset-a-dataframe"><i class="fa fa-check"></i><b>4.5.3</b> Other Ways to Subset a Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-manip.html"><a href="data-manip.html#factors"><i class="fa fa-check"></i><b>4.6</b> Factors</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-manip.html"><a href="data-manip.html#creating-factors-with-gl"><i class="fa fa-check"></i><b>4.6.1</b> Creating Factors with <code id="gl">gl</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-manip.html"><a href="data-manip.html#getting-info-on-r-objects"><i class="fa fa-check"></i><b>4.7</b> Getting Info on R Objects</a></li>
<li class="chapter" data-level="4.8" data-path="data-manip.html"><a href="data-manip.html#changing-the-format-of-your-data"><i class="fa fa-check"></i><b>4.8</b> Changing the Format of Your Data</a><ul>
<li class="chapter" data-level="4.8.1" data-path="data-manip.html"><a href="data-manip.html#the-one-row-per-observation-format"><i class="fa fa-check"></i><b>4.8.1</b> The “One Row per Observation” Format</a></li>
<li class="chapter" data-level="4.8.2" data-path="data-manip.html"><a href="data-manip.html#stack"><i class="fa fa-check"></i><b>4.8.2</b> The <code>stack</code> and <code>unstack</code> functions</a></li>
<li class="chapter" data-level="4.8.3" data-path="data-manip.html"><a href="data-manip.html#tapply"><i class="fa fa-check"></i><b>4.8.3</b> The <code>tapply</code> and <code>aggregate</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="data-manip.html"><a href="data-manip.html#creating-and-editing-data-objects-through-a-visual-interface"><i class="fa fa-check"></i><b>4.9</b> Creating and Editing Data Objects through a Visual Interface</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualising-your-data.html"><a href="visualising-your-data.html"><i class="fa fa-check"></i><b>5</b> Visualising Your Data</a><ul>
<li class="chapter" data-level="5.1" data-path="visualising-your-data.html"><a href="visualising-your-data.html#reading-numbers-in-exponential-notation"><i class="fa fa-check"></i><b>5.1</b> Reading Numbers in Exponential Notation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="IO.html"><a href="IO.html"><i class="fa fa-check"></i><b>6</b> File Input/Output</a><ul>
<li class="chapter" data-level="6.1" data-path="IO.html"><a href="IO.html#reading-in-data-from-a-file"><i class="fa fa-check"></i><b>6.1</b> Reading In Data from a File</a><ul>
<li class="chapter" data-level="6.1.1" data-path="IO.html"><a href="IO.html#read.table"><i class="fa fa-check"></i><b>6.1.1</b> The <code>read.table</code> function</a></li>
<li class="chapter" data-level="6.1.2" data-path="IO.html"><a href="IO.html#scan"><i class="fa fa-check"></i><b>6.1.2</b> <code id="scan">scan</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="IO.html"><a href="IO.html#low-level-file-input"><i class="fa fa-check"></i><b>6.1.3</b> Low-Level File Input</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="IO.html"><a href="IO.html#writing-data-to-a-file"><i class="fa fa-check"></i><b>6.2</b> Writing Data to a file</a><ul>
<li class="chapter" data-level="6.2.1" data-path="IO.html"><a href="IO.html#write.table"><i class="fa fa-check"></i><b>6.2.1</b> The <code>write.table</code> function</a></li>
<li class="chapter" data-level="6.2.2" data-path="IO.html"><a href="IO.html#cat"><i class="fa fa-check"></i><b>6.2.2</b> Low-Level File Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>7</b> Descriptive</a><ul>
<li class="chapter" data-level="7.1" data-path="descriptive.html"><a href="descriptive.html#tables"><i class="fa fa-check"></i><b>7.1</b> Tables</a></li>
<li class="chapter" data-level="7.2" data-path="descriptive.html"><a href="descriptive.html#the-scale-function"><i class="fa fa-check"></i><b>7.2</b> The <code>scale</code> Function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>8</b> Graphics</a><ul>
<li class="chapter" data-level="8.1" data-path="graphics.html"><a href="graphics.html#overview-of-r-graphics"><i class="fa fa-check"></i><b>8.1</b> Overview of R Graphics</a></li>
<li class="chapter" data-level="8.2" data-path="graphics.html"><a href="graphics.html#plot"><i class="fa fa-check"></i><b>8.2</b> The <code>plot</code> Function</a></li>
<li class="chapter" data-level="8.3" data-path="graphics.html"><a href="graphics.html#drawing-functions"><i class="fa fa-check"></i><b>8.3</b> Drawing Functions</a><ul>
<li class="chapter" data-level="8.3.1" data-path="graphics.html"><a href="graphics.html#the-matplot-function"><i class="fa fa-check"></i><b>8.3.1</b> The <code>matplot</code> function</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="graphics.html"><a href="graphics.html#barplots"><i class="fa fa-check"></i><b>8.4</b> Barplots</a><ul>
<li class="chapter" data-level="8.4.1" data-path="graphics.html"><a href="graphics.html#barplots-with-error-bars"><i class="fa fa-check"></i><b>8.4.1</b> Barplots with Error Bars</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>8.5</b> Boxplots</a></li>
<li class="chapter" data-level="8.6" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>8.6</b> Histograms</a></li>
<li class="chapter" data-level="8.7" data-path="graphics.html"><a href="graphics.html#stripcharts"><i class="fa fa-check"></i><b>8.7</b> Stripcharts</a></li>
<li class="chapter" data-level="8.8" data-path="graphics.html"><a href="graphics.html#interaction-plots"><i class="fa fa-check"></i><b>8.8</b> Interaction Plots</a></li>
<li class="chapter" data-level="8.9" data-path="graphics.html"><a href="graphics.html#par"><i class="fa fa-check"></i><b>8.9</b> Setting Graphics Parameters</a><ul>
<li class="chapter" data-level="8.9.1" data-path="graphics.html"><a href="graphics.html#lty"><i class="fa fa-check"></i><b>8.9.1</b> Line type with the <code>lty</code> parameter</a></li>
<li class="chapter" data-level="8.9.2" data-path="graphics.html"><a href="graphics.html#secpch"><i class="fa fa-check"></i><b>8.9.2</b> Symbols with the <code>pch</code> parameter</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="graphics.html"><a href="graphics.html#adding-elements-to-a-plot"><i class="fa fa-check"></i><b>8.10</b> Adding Elements to a Plot</a><ul>
<li class="chapter" data-level="8.10.1" data-path="graphics.html"><a href="graphics.html#legend"><i class="fa fa-check"></i><b>8.10.1</b> Adding a Legend</a></li>
<li class="chapter" data-level="8.10.2" data-path="graphics.html"><a href="graphics.html#adding-text"><i class="fa fa-check"></i><b>8.10.2</b> Adding Text</a></li>
<li class="chapter" data-level="8.10.3" data-path="graphics.html"><a href="graphics.html#addgrid"><i class="fa fa-check"></i><b>8.10.3</b> Adding a Grid</a></li>
<li class="chapter" data-level="8.10.4" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>8.10.4</b> Setting the Axes</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="graphics.html"><a href="graphics.html#creating-layouts-for-multiple-graphs-glayout"><i class="fa fa-check"></i><b>8.11</b> Creating Layouts for Multiple Graphs {glayout}</a><ul>
<li class="chapter" data-level="8.11.1" data-path="graphics.html"><a href="graphics.html#mfrow-and-mfcol-mfrowmfcol"><i class="fa fa-check"></i><b>8.11.1</b> mfrow and mfcol {mfrowmfcol}</a></li>
<li class="chapter" data-level="8.11.2" data-path="graphics.html"><a href="graphics.html#layout"><i class="fa fa-check"></i><b>8.11.2</b> layout</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="graphics.html"><a href="graphics.html#graphics-device-regions-and-coordinates"><i class="fa fa-check"></i><b>8.12</b> Graphics Device Regions and Coordinates</a></li>
<li class="chapter" data-level="8.13" data-path="graphics.html"><a href="graphics.html#plotfromscratch"><i class="fa fa-check"></i><b>8.13</b> Plotting from Scratch</a></li>
<li class="chapter" data-level="8.14" data-path="graphics.html"><a href="graphics.html#colours-for-graphics"><i class="fa fa-check"></i><b>8.14</b> Colours for Graphics</a></li>
<li class="chapter" data-level="8.15" data-path="graphics.html"><a href="graphics.html#managing-graphic-devices"><i class="fa fa-check"></i><b>8.15</b> Managing Graphic Devices</a><ul>
<li class="chapter" data-level="8.15.1" data-path="graphics.html"><a href="graphics.html#opening-another-graphics-window"><i class="fa fa-check"></i><b>8.15.1</b> Opening Another Graphics Window</a></li>
<li class="chapter" data-level="8.15.2" data-path="graphics.html"><a href="graphics.html#exporting-graphics"><i class="fa fa-check"></i><b>8.15.2</b> Exporting Graphics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>9</b> ggplot2</a></li>
<li class="chapter" data-level="10" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>10</b> Plotly</a><ul>
<li class="chapter" data-level="10.1" data-path="plotly.html"><a href="plotly.html#using-plotly-with-knitr"><i class="fa fa-check"></i><b>10.1</b> Using plotly with knitr</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="trellis.html"><a href="trellis.html"><i class="fa fa-check"></i><b>11</b> Lattice or Trellis Graphics</a><ul>
<li class="chapter" data-level="11.1" data-path="trellis.html"><a href="trellis.html#overview-of-lattice-graphics"><i class="fa fa-check"></i><b>11.1</b> Overview of Lattice Graphics</a></li>
<li class="chapter" data-level="11.2" data-path="trellis.html"><a href="trellis.html#introduction-to-model-formulae-and-multi-panel-conditioning"><i class="fa fa-check"></i><b>11.2</b> Introduction to model formulae and multi-panel conditioning</a></li>
<li class="chapter" data-level="11.3" data-path="trellis.html"><a href="trellis.html#barchart"><i class="fa fa-check"></i><b>11.3</b> <code>barchart</code></a></li>
<li class="chapter" data-level="11.4" data-path="trellis.html"><a href="trellis.html#dotplot"><i class="fa fa-check"></i><b>11.4</b> dotplot</a></li>
<li class="chapter" data-level="11.5" data-path="trellis.html"><a href="trellis.html#histogram"><i class="fa fa-check"></i><b>11.5</b> histogram</a></li>
<li class="chapter" data-level="11.6" data-path="trellis.html"><a href="trellis.html#interaction-plots-1"><i class="fa fa-check"></i><b>11.6</b> Interaction Plots</a></li>
<li class="chapter" data-level="11.7" data-path="trellis.html"><a href="trellis.html#customizingtrellis"><i class="fa fa-check"></i><b>11.7</b> Customising Lattice Graphics</a><ul>
<li class="chapter" data-level="11.7.1" data-path="trellis.html"><a href="trellis.html#textual-elements"><i class="fa fa-check"></i><b>11.7.1</b> Textual Elements</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="trellis.html"><a href="trellis.html#trellispanel"><i class="fa fa-check"></i><b>11.8</b> Writing Panel Functions</a><ul>
<li class="chapter" data-level="11.8.1" data-path="trellis.html"><a href="trellis.html#combining-panel-functions"><i class="fa fa-check"></i><b>11.8.1</b> Combining Panel Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html"><i class="fa fa-check"></i><b>12</b> Probability Distribution Functions</a><ul>
<li class="chapter" data-level="12.1" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#bernoulli"><i class="fa fa-check"></i><b>12.1</b> The Bernoulli distribution</a></li>
<li class="chapter" data-level="12.2" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#binomial"><i class="fa fa-check"></i><b>12.2</b> The binomial distribution</a></li>
<li class="chapter" data-level="12.3" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#normal"><i class="fa fa-check"></i><b>12.3</b> The normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>13</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="13.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi2-test"><i class="fa fa-check"></i><b>13.1</b> <span class="math">\(\chi^2\)</span> test</a><ul>
<li class="chapter" data-level="13.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-hypotheses-about-the-distribution-of-a-categorical-variable"><i class="fa fa-check"></i><b>13.1.1</b> Testing Hypotheses about the Distribution of a Categorical Variable</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#students-t-test"><i class="fa fa-check"></i><b>13.2</b> Student’s <em>t</em> test</a><ul>
<li class="chapter" data-level="13.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>13.2.1</b> One sample <em>t</em>-test</a></li>
<li class="chapter" data-level="13.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-samples-t-test"><i class="fa fa-check"></i><b>13.2.2</b> Two samples t-test</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-levene-test-for-homogeneity-of-variances"><i class="fa fa-check"></i><b>13.3</b> The Levene Test for Homogeneity of Variances</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>14</b> Correlation and Regression</a><ul>
<li class="chapter" data-level="14.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#linear-regression"><i class="fa fa-check"></i><b>14.1</b> Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>15</b> ANOVA</a><ul>
<li class="chapter" data-level="15.1" data-path="anova.html"><a href="anova.html#one-way-anova"><i class="fa fa-check"></i><b>15.1</b> One-Way ANOVA</a></li>
<li class="chapter" data-level="15.2" data-path="anova.html"><a href="anova.html#repeated-measures-anova"><i class="fa fa-check"></i><b>15.2</b> Repeated Measures ANOVA</a><ul>
<li class="chapter" data-level="15.2.1" data-path="anova.html"><a href="anova.html#one-within-subjects-factor"><i class="fa fa-check"></i><b>15.2.1</b> One Within Subjects Factor</a></li>
<li class="chapter" data-level="15.2.2" data-path="anova.html"><a href="anova.html#two-within-subjects-factors"><i class="fa fa-check"></i><b>15.2.2</b> Two Within Subjects Factors</a></li>
<li class="chapter" data-level="15.2.3" data-path="anova.html"><a href="anova.html#two-within-subjects-factors-and-one-between"><i class="fa fa-check"></i><b>15.2.3</b> Two Within Subjects Factors and One Between</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="how-to-adjust-the-p-values-for-multiple-comparisons.html"><a href="how-to-adjust-the-p-values-for-multiple-comparisons.html"><i class="fa fa-check"></i><b>16</b> How to Adjust the p-values for Multiple Comparisons</a></li>
<li class="chapter" data-level="17" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>17</b> R Programming</a><ul>
<li class="chapter" data-level="17.1" data-path="programming.html"><a href="programming.html#contrstruct"><i class="fa fa-check"></i><b>17.1</b> Control Structures</a></li>
<li class="chapter" data-level="17.2" data-path="programming.html"><a href="programming.html#stringprocessing"><i class="fa fa-check"></i><b>17.2</b> String Processing</a><ul>
<li class="chapter" data-level="17.2.1" data-path="programming.html"><a href="programming.html#regexp"><i class="fa fa-check"></i><b>17.2.1</b> Using Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="programming.html"><a href="programming.html#tips-and-tricks"><i class="fa fa-check"></i><b>17.3</b> Tips and Tricks</a><ul>
<li class="chapter" data-level="17.3.1" data-path="programming.html"><a href="programming.html#convert-a-string-into-a-command"><i class="fa fa-check"></i><b>17.3.1</b> Convert a String into a Command</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="programming.html"><a href="programming.html#creatingsimplerpackages"><i class="fa fa-check"></i><b>17.4</b> Creating Simple R Packages</a><ul>
<li class="chapter" data-level="17.4.1" data-path="programming.html"><a href="programming.html#the-bare-minimum-to-create-a-package"><i class="fa fa-check"></i><b>17.4.1</b> The Bare Minimum to Create a Package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="custom.html"><a href="custom.html"><i class="fa fa-check"></i><b>18</b> Environment Customisation</a></li>
<li class="chapter" data-level="19" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html"><i class="fa fa-check"></i><b>19</b> ESS: Using Emacs Speaks Statistics with R</a><ul>
<li class="chapter" data-level="19.1" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-for-editing-and-debugging-r-source-files"><i class="fa fa-check"></i><b>19.1</b> Using ESS for Editing and Debugging R Source Files</a></li>
<li class="chapter" data-level="19.2" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-to-interact-with-a-r-process"><i class="fa fa-check"></i><b>19.2</b> Using ESS to Interact with a R Process</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html"><i class="fa fa-check"></i><b>20</b> Using Sweave to Write Documents with R and LaTeX</a><ul>
<li class="chapter" data-level="20.1" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#whats-sweave"><i class="fa fa-check"></i><b>20.1</b> What’s Sweave?</a></li>
<li class="chapter" data-level="20.2" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#usage"><i class="fa fa-check"></i><b>20.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="soundprocessing.html"><a href="soundprocessing.html"><i class="fa fa-check"></i><b>21</b> Sound Processing</a><ul>
<li class="chapter" data-level="21.1" data-path="soundprocessing.html"><a href="soundprocessing.html#libraries-for-sound-analysis-and-signal-processing"><i class="fa fa-check"></i><b>21.1</b> Libraries for Sound Analysis and Signal Processing</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html"><i class="fa fa-check"></i><b>A</b> Partial List of Packages by Category</a><ul>
<li class="chapter" data-level="A.1" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#graphics-packages"><i class="fa fa-check"></i><b>A.1</b> Graphics Packages</a></li>
<li class="chapter" data-level="A.2" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#gui-packages"><i class="fa fa-check"></i><b>A.2</b> GUI Packages</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="miscellaneous-commands.html"><a href="miscellaneous-commands.html"><i class="fa fa-check"></i><b>B</b> Miscellaneous commands</a></li>
<li class="chapter" data-level="C" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html"><i class="fa fa-check"></i><b>C</b> Other Manuals and Sources of Information on R</a><ul>
<li class="chapter" data-level="C.0.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian"><i class="fa fa-check"></i><b>C.0.1</b> In Italian</a></li>
<li class="chapter" data-level="C.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#other-useful-statistics-resources"><i class="fa fa-check"></i><b>C.1</b> Other useful statistics resources</a><ul>
<li class="chapter" data-level="C.1.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian-1"><i class="fa fa-check"></i><b>C.1.1</b> In Italian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="full-colours-table-fullcoltable.html"><a href="full-colours-table-fullcoltable.html"><i class="fa fa-check"></i><b>D</b> Full Colours Table (#fullcoltable}</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A R Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trellis" class="section level1">
<h1><span class="header-section-number">11</span> Lattice or Trellis Graphics</h1>
<p>The lattice package in R provides an alternative to the base graphics system, it is an implementation of the ideas developed and implemented by Rick Becker and Bill Cleveland in the Trellis graphics system for the S language. Trellis displays were developed as a framework to make it easy the display of the relationship between a dependent variable and multiple factors. The lattice package allows you to do some wonderful things, however it’s not always easy to use, and its syntax differs from the R base graphics system. Since lattice is mostly compatible with the Trellis graphics system in S-Plus, the following documents written for Trellis probably provide the best introduction to lattice and to the concept of trellis displays:</p>
<ul>
<li>S-PLUS Trellis Graphics User’s Manual <span class="citation">Becker and Cleveland (2002)</span></li>
<li>A Tour of Trellis Graphics <span class="citation">Becker et al. (1996)</span></li>
</ul>
<p>they can both be downloaded at the following URL: <a href="http://cm.bell-labs.com/cm/ms/departments/sia/project/trellis/software.writing.html">http://cm.bell-labs.com/cm/ms/departments/sia/project/trellis/software.writing.html</a></p>
<p>As usual the definitive reference is provided by the (especially in this case not very beginner-friendly) package documentation:</p>
<ul>
<li>Lattice Reference Manual <a href="http://cran.r-project.org/doc/packages/lattice.pdf">http://cran.r-project.org/doc/packages/lattice.pdf</a></li>
</ul>
<p>the following articles also contain useful info:</p>
<ul>
<li>Some notes on lattice <span class="citation">Sarkar (2003)</span> <a href="http://www.ci.tuwien.ac.at/Conferences/DSC-2003/Proceedings/Sarkar.pdf">http://www.ci.tuwien.ac.at/Conferences/DSC-2003/Proceedings/Sarkar.pdf</a></li>
<li>R Lattice Graphics <span class="citation">Murrell (2001)</span> <a href="http://www.ci.tuwien.ac.at/Conferences/DSC-2001/Proceedings/Murrell.pdf">http://www.ci.tuwien.ac.at/Conferences/DSC-2001/Proceedings/Murrell.pdf</a></li>
<li>Lattice, an implementation of Trellis graphics in R <span class="citation">Sarkar (2002)</span> <a href="http://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf">http://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf</a></li>
<li>The Visual Design and Control of Trellis Display <span class="citation">Becker, Cleveland, and Shyu (1996)</span> <a href="http://cm.bell-labs.com/stat/doc/trellis.jcgs.col.ps">http://cm.bell-labs.com/stat/doc/trellis.jcgs.col.ps</a></li>
<li>Trellis Display: Modelling Data from Designed Experiments <span class="citation">W. S. Cleveland and Fuentes (1997)</span> <a href="http://cm.bell-labs.com/stat/doc/doe.trellis.col.ps">http://cm.bell-labs.com/stat/doc/doe.trellis.col.ps</a></li>
</ul>
<div id="overview-of-lattice-graphics" class="section level2">
<h2><span class="header-section-number">11.1</span> Overview of Lattice Graphics</h2>
<table>
<caption><span id="tab:latticefunctions">Table 11.1: </span> Lattice graphics functions.</caption>
<thead>
<tr class="header">
<th align="left">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>xyplot</code></td>
</tr>
<tr class="even">
<td align="left"><code>barchart</code></td>
</tr>
<tr class="odd">
<td align="left"><code>dotplot</code></td>
</tr>
<tr class="even">
<td align="left"><code>stripplot</code></td>
</tr>
<tr class="odd">
<td align="left"><code>bwplot</code></td>
</tr>
</tbody>
</table>
</div>
<div id="introduction-to-model-formulae-and-multi-panel-conditioning" class="section level2">
<h2><span class="header-section-number">11.2</span> Introduction to model formulae and multi-panel conditioning</h2>
<p>We will use the <code>rats_trellis.txt</code> dataset to illustrate how conditioning based on one or more factors work in lattice. The dataset contains data from a fictitious experiment in which a researcher is investigating the effects of alcohol and drug consumption on social interactions in rats. The researcher studies two species of rats (Kalamani vs Yuppy), each rat has been observed in four experimental conditions, given by the combination of two factors: administration of drug (Drug vs No-Drug) and administration of alcohol (Al vs No-Al). The dependent variable is the number of social interactions observed in each of the four conditions. We’ll read in the data first:</p>
<pre class="sourceCode r"><code class="sourceCode r">dats &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;datasets/rats_trellis.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
dats$subj &lt;-<span class="st"> </span><span class="kw">as.factor</span>(dats$subj)
<span class="kw">head</span>(dats)</code></pre>
<pre><code>##   subj socialint alcohol    drug species
## 1    1         7      Al    Drug   Yuppy
## 2    1         6   No-Al    Drug   Yuppy
## 3    1         6      Al No-Drug   Yuppy
## 4    1         4   No-Al No-Drug   Yuppy
## 5    2         5      Al    Drug   Yuppy
## 6    2         4   No-Al    Drug   Yuppy</code></pre>
<p>we’ll start visualising the data along one dimension, the species. This is a single dimension, that can be easily handled by the base graphics system, but can be equally well displayed with lattice. Since the high level lattice plotting functions require the data to be entered as a dataframe, we’ll use the <code>aggregate</code> function to get a dataframe with the mean values of <code>socialint</code>, the dependent variable, on the bases of the species:</p>
<pre class="sourceCode r"><code class="sourceCode r">bySpec &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dats$socialint, 
                    <span class="dt">by=</span><span class="kw">list</span>(<span class="dt">species=</span>dats$species), <span class="dt">FUN=</span>mean)
<span class="kw">names</span>(bySpec)[<span class="kw">which</span>(<span class="kw">names</span>(bySpec)==<span class="st">&quot;x&quot;</span>)] &lt;-<span class="st"> &quot;socialint&quot;</span>
bySpec</code></pre>
<pre><code>##    species socialint
## 1 Kalamani    5.3125
## 2    Yuppy    5.6875</code></pre>
<p>lattice uses a model formula syntax, you give it a dataframe, and specify how you want a variable to be displayed along the dimensions of one or more factors. In our case, we want <code>socialint ~ species</code> (you could read the <code>~</code> “as explained by species”), the barchart can be produced with the code below, and is displayed in Figure <a href="trellis.html#fig:ratstrellis1">11.1</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
##trellis.device() #optional
pl1 &lt;-<span class="st"> </span><span class="kw">barchart</span>(socialint ~<span class="st"> </span>species, <span class="dt">data=</span>bySpec)
<span class="kw">print</span>(pl1)</code></pre>
<div class="figure"><span id="fig:ratstrellis1"></span>
<img src="graphics_lattice_files/figure-html/ratstrellis1-1.png" alt="Social interactions by species" width="672" />
<p class="caption">
Figure 11.1: Social interactions by species
</p>
</div>
<p>Now suppose we want to visualise the relationship between <code>socialint</code> and <code>species</code> on the bases of alcohol administration. We could achieve also this with the barplot in the base graphics system. In lattice there are two ways of doing it, one is by the use of a ``grouping’’ factor, this yields a display similar to the barplot function. The second way is by multi-panel factor conditioning. The advantage of multi-panel conditioning, as we will see soon, is that it can be extended to an unlimited number of factors. Let’s start with the first solution, in which we use a grouping factor. First we create a suitable dataframe:</p>
<pre class="sourceCode r"><code class="sourceCode r">bySpecAl &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dats$socialint, 
                      <span class="dt">by=</span><span class="kw">list</span>(<span class="dt">species=</span>dats$species, 
                          <span class="dt">alcohol=</span>dats$alcohol), <span class="dt">FUN=</span>mean)
<span class="kw">names</span>(bySpecAl)[<span class="kw">which</span>(<span class="kw">names</span>(bySpecAl)==<span class="st">&quot;x&quot;</span>)] &lt;-<span class="st"> &quot;socialint&quot;</span></code></pre>
<p>then we produce the barchart which you can see in Figure <a href="trellis.html#fig:ratstrellis2">11.2</a></p>
<pre class="sourceCode r"><code class="sourceCode r">pl2 &lt;-<span class="st"> </span><span class="kw">barchart</span>(socialint ~<span class="st"> </span>species, <span class="dt">groups=</span>alcohol, 
                 <span class="dt">data=</span>bySpecAl, <span class="dt">auto.key=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(pl2)</code></pre>
<div class="figure"><span id="fig:ratstrellis2"></span>
<img src="graphics_lattice_files/figure-html/ratstrellis2-1.png" alt="Social interactions by species and alcohol administration with grouping factor" width="672" />
<p class="caption">
Figure 11.2: Social interactions by species and alcohol administration with grouping factor
</p>
</div>
<p>the grouping factor is given by the <code>groups</code> argument, notice also that we have set <code>auto.key</code> to <code>TRUE</code> in order to add an automatic legend.</p>
<p>the second way of doing the graph is by multi-panel conditioning, we achieve this by putting alcohol as a conditioning factor with the <code>|</code> syntax.</p>
<pre class="sourceCode r"><code class="sourceCode r">pl3 &lt;-<span class="st"> </span><span class="kw">barchart</span>(socialint ~<span class="st"> </span>species |<span class="st"> </span>alcohol, <span class="dt">data=</span>bySpecAl)
<span class="kw">print</span>(pl3)</code></pre>
<div class="figure"><span id="fig:ratstrellis3"></span>
<img src="graphics_lattice_files/figure-html/ratstrellis3-1.png" alt="Social Interactions by species and alcohol administration with multi-panel conditioning" width="672" />
<p class="caption">
Figure 11.3: Social Interactions by species and alcohol administration with multi-panel conditioning
</p>
</div>
<p>the resulting graph is displayed in Figure <a href="trellis.html#fig:ratstrellis3">11.3</a>. We could have swapped <code>species</code> for <code>alcohol</code> as the conditioning factor, which way gives the more effective display depends from case to case, and it’s up to the user to decide. Finally we’ll consider the case in which all factors are included in the display, this cannot be easily achieved with traditional graphics, but it is easily done in lattice, we just add <code>drug</code> to the conditioning factors (Figure <a href="trellis.html#fig:ratstrellis4">11.4</a>)</p>
<pre class="sourceCode r"><code class="sourceCode r">bySpecAlDrug &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dats$socialint, 
                          <span class="dt">by=</span><span class="kw">list</span>(<span class="dt">species=</span>dats$species, 
                          <span class="dt">alcohol=</span>dats$alcohol, <span class="dt">drug=</span>dats$drug), 
                          <span class="dt">FUN=</span>mean)
<span class="kw">names</span>(bySpecAlDrug)[<span class="kw">which</span>(<span class="kw">names</span>(bySpecAlDrug)==<span class="st">&quot;x&quot;</span>)] &lt;-<span class="st"> &quot;socialint&quot;</span>
pl4 &lt;-<span class="st"> </span><span class="kw">barchart</span>(socialint ~<span class="st"> </span>species |<span class="st"> </span>alcohol *<span class="st"> </span>drug, 
                <span class="dt">data=</span>bySpecAlDrug)
<span class="kw">print</span>(pl4)</code></pre>
<div class="figure"><span id="fig:ratstrellis4"></span>
<img src="graphics_lattice_files/figure-html/ratstrellis4-1.png" alt="Social interactions by species, alcohol administration and drug with multi-panel conditioning" width="672" />
<p class="caption">
Figure 11.4: Social interactions by species, alcohol administration and drug with multi-panel conditioning
</p>
</div>
<p>we could have used a grouping variable also in this case rather than using two conditioning factors (Figure <a href="trellis.html#fig:ratstrellis5">11.5</a>)</p>
<pre class="sourceCode r"><code class="sourceCode r">pl5 &lt;-<span class="st"> </span><span class="kw">barchart</span>(socialint ~<span class="st"> </span>species |<span class="st"> </span>alcohol, 
                <span class="dt">groups=</span>drug, <span class="dt">data=</span>bySpecAlDrug,
                <span class="dt">auto.key=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(pl5)</code></pre>
<div class="figure"><span id="fig:ratstrellis5"></span>
<img src="graphics_lattice_files/figure-html/ratstrellis5-1.png" alt="Social interactions by species, alcohol administration and drug with grouping factor" width="672" />
<p class="caption">
Figure 11.5: Social interactions by species, alcohol administration and drug with grouping factor
</p>
</div>
<p>again what is the best display is up to the user to decide and depends from case to case.</p>
</div>
<div id="barchart" class="section level2">
<h2><span class="header-section-number">11.3</span> <code>barchart</code></h2>
<p>We will look at an example of a barchart display of a dependent measure conditional on three factors. The dataset <code>line_matching.txt</code> contains data on an imaginary experiment in which a psychophysicist wants to measure the accuracy of matching the length of a segment for three groups of people (Gr.~1, Gr.~2, Gr.~3) for segments of four different lengths (L1, L2, L3, L4). The third factor the psychophysicist is interested in is whether matching accuracy changes depending on the colour (blue vs red) of the segment to be matched, he measures this as a within subjects factor. The matching accuracy is measured as the error, or displacement (positive or negative) from the actual segment length. The dataset contains the mean values for the three groups. Below is the code for producing the barchart, the resulting plot can be seen in Figure @ref(fig:line_matching):</p>
<pre class="sourceCode r"><code class="sourceCode r">dats &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;datasets/line_matching.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="co">#trellis.device()</span>
oldpar &lt;-<span class="st"> </span><span class="kw">trellis.par.get</span>(<span class="st">&quot;superpose.polygon&quot;</span>)
<span class="kw">trellis.par.set</span>(<span class="dt">superpose.polygon =</span> 
<span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkslateblue&quot;</span>, <span class="st">&quot;indianred&quot;</span>)))
myGraph &lt;-<span class="st"> </span><span class="kw">barchart</span>(error ~<span class="st"> </span>length |<span class="st"> </span>group, <span class="dt">groups=</span>color, 
           <span class="dt">data=</span>dats, <span class="dt">origin=</span><span class="dv">0</span>, <span class="dt">ylab=</span><span class="st">&quot;Error (cm)&quot;</span>, 
           <span class="dt">xlab=</span><span class="st">&quot;Segment Length&quot;</span>, 
           <span class="dt">auto.key=</span><span class="ot">TRUE</span>, <span class="dt">as.table=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(myGraph)</code></pre>
<div class="figure"><span id="fig:linematching"></span>
<img src="graphics_lattice_files/figure-html/linematching-1.png" alt="Line matching barchart" width="672" />
<p class="caption">
Figure 11.6: Line matching barchart
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">trellis.par.set</span>(<span class="dt">superpose.polygon =</span> oldpar)</code></pre>
<p>We’re showing the bars for the two levels of the “colour” factor side by side in the same panel, this is done by using the factor in the <code>groups</code> argument. A different display could have been achieved by putting the “colour” factor as an additional conditioning variable:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barchart</span>(error ~<span class="st"> </span>length |<span class="st"> </span>group *<span class="st"> </span>color, 
         <span class="dt">data=</span>dats, <span class="dt">origin=</span><span class="dv">0</span>, <span class="dt">ylab=</span><span class="st">&quot;Error (cm)&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Segment Length&quot;</span>, 
         <span class="dt">auto.key=</span><span class="ot">TRUE</span>, <span class="dt">as.table=</span><span class="ot">TRUE</span>)</code></pre>
<p>in this case the bars for each level of the factor would have been drawn in different panels (the number of panels would have doubled).</p>
<p>The fill colour for the bars can be modified changing the colour option for <code>superpose.polygon</code>.</p>
<p>The great thing about trellis graphics is that they allow you to display the relationship between a dependent variable and multiple factors seamlessly. Suppose that, continuing the above example, the psychophysician has tested the line matching accuracy on the three groups both before and after a period of visuo-motor training. The dataset containing the data with this new factor is in the file <code>line_matching_training.txt</code>. We just need to add the new factor <code>session</code> (pre-training vs post-training) to the conditioning variables to obtain the new plot. The modified call to the <code>barchart</code> function is shown below and the resulting graph can be seen in Figure <a href="trellis.html#fig:linematchingtraining">11.7</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">dats =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;datasets/line_matching_training.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
myGraph &lt;-<span class="st"> </span><span class="kw">barchart</span>(error ~<span class="st"> </span>length |<span class="st"> </span>group *<span class="st"> </span>session, <span class="dt">groups=</span>color, 
                    <span class="dt">data=</span>dats, <span class="dt">origin=</span><span class="dv">0</span>, <span class="dt">ylab=</span><span class="st">&quot;Error (cm)&quot;</span>, 
                    <span class="dt">xlab=</span><span class="st">&quot;Segment Length&quot;</span>, 
                    <span class="dt">auto.key=</span><span class="ot">TRUE</span>, <span class="dt">as.table=</span><span class="ot">TRUE</span>)
<span class="kw">print</span>(myGraph)</code></pre>
<div class="figure"><span id="fig:linematchingtraining"></span>
<img src="graphics_lattice_files/figure-html/linematchingtraining-1.png" alt="Line matching training barchart" width="672" />
<p class="caption">
Figure 11.7: Line matching training barchart
</p>
</div>
</div>
<div id="dotplot" class="section level2">
<h2><span class="header-section-number">11.4</span> dotplot</h2>
</div>
<div id="histogram" class="section level2">
<h2><span class="header-section-number">11.5</span> histogram</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">histogram</span>(dats$adj)
<span class="kw">histogram</span>(~dats$adj|dats$congr)</code></pre>
</div>
<div id="interaction-plots-1" class="section level2">
<h2><span class="header-section-number">11.6</span> Interaction Plots</h2>
<p>Example of interaction plot with 3 factors:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">bwplot</span>(dats$lat~dats$congr|dats$acc,<span class="dt">groups=</span>dats$isi,
     <span class="dt">panel=</span><span class="st">&#39;panel.superpose&#39;</span>,<span class="dt">panel.groups=</span><span class="st">&#39;panel.linejoin&#39;</span>,
     <span class="dt">auto.key=</span><span class="kw">list</span>(<span class="dt">points=</span><span class="ot">FALSE</span>,<span class="dt">lines=</span><span class="ot">TRUE</span>,<span class="dt">space=</span><span class="st">&#39;top&#39;</span>),
     <span class="dt">scales=</span><span class="kw">list</span>(<span class="dt">cex=</span>.<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">280</span>,<span class="dv">400</span>),
     <span class="dt">ylab=</span><span class="st">&#39;Medie delle latenze in ms&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;SOA&#39;</span>))</code></pre>
</div>
<div id="customizingtrellis" class="section level2">
<h2><span class="header-section-number">11.7</span> Customising Lattice Graphics</h2>
<div id="textual-elements" class="section level3">
<h3><span class="header-section-number">11.7.1</span> Textual Elements</h3>
<div id="strip-labels" class="section level4">
<h4><span class="header-section-number">11.7.1.1</span> Strip Labels</h4>
<p>The labels of the panels strips are the names of the levels of the conditioning factor variable. To change the labels just change the names for the factor levels:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(dats$acc)
  [<span class="dv">1</span>] <span class="st">&quot;e&quot;</span> <span class="st">&quot;h&quot;</span>
<span class="kw">levels</span>(dats$acc)[<span class="dv">1</span>]
  [<span class="dv">1</span>] <span class="st">&quot;e&quot;</span>
<span class="kw">levels</span>(dats$acc)[<span class="dv">1</span>]&lt;-<span class="st">&#39;imprecise&#39;</span>
<span class="kw">levels</span>(dats$acc)[<span class="dv">2</span>]&lt;-<span class="st">&#39;corrette&#39;</span>
<span class="kw">levels</span>(dats$acc)
  [<span class="dv">1</span>] <span class="st">&quot;imprecise&quot;</span> <span class="st">&quot;corrette&quot;</span> </code></pre>
</div>
</div>
</div>
<div id="trellispanel" class="section level2">
<h2><span class="header-section-number">11.8</span> Writing Panel Functions</h2>
<div id="combining-panel-functions" class="section level3">
<h3><span class="header-section-number">11.8.1</span> Combining Panel Functions</h3>
<p>Rather than writing a new panel function from scratch, often you just want to add some elements to a plot, for example a regression line, or error bars. The easiest and probably best way to do this is writing a panel function that combines two standard panel functions. There is a number of predefined panel functions (see <code>?panel.functions</code>) that can be used to add lines, grids etc…, to a scatterplot, barchart or other higher level plotting lattice function.</p>
<p>We will start with a very simple example, adding a horizontal line at a fixed height in a dotplot. The <code>line_matching</code> dataset described in the barchart example, can be very well visualised also through a dotplot (Figure <a href="trellis.html#fig:lmatchdotplot">11.8</a>)</p>
<pre class="sourceCode r"><code class="sourceCode r">oldpar &lt;-<span class="st"> </span><span class="kw">trellis.par.get</span>(<span class="st">&quot;superpose.symbol&quot;</span>)
<span class="kw">trellis.par.set</span>(<span class="dt">superpose.symbol =</span> 
                <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkslateblue&quot;</span>, 
                <span class="st">&quot;indianred&quot;</span>), <span class="dt">pch=</span><span class="dv">19</span>))
<span class="kw">dotplot</span>(error ~<span class="st"> </span>length |<span class="st"> </span>group, <span class="dt">groups=</span>color, 
        <span class="dt">data=</span>dats, <span class="dt">origin=</span><span class="dv">0</span>, <span class="dt">ylab=</span><span class="st">&quot;Error (cm)&quot;</span>, 
        <span class="dt">xlab=</span><span class="st">&quot;Segment Length&quot;</span>, <span class="dt">auto.key=</span><span class="ot">TRUE</span>, 
        <span class="dt">aspect=</span><span class="dv">1</span>, <span class="dt">as.table=</span><span class="ot">TRUE</span>)</code></pre>
<div class="figure"><span id="fig:lmatchdotplot"></span>
<img src="graphics_lattice_files/figure-html/lmatchdotplot-1.png" alt="Dotplot of the line matching dataset" width="672" />
<p class="caption">
Figure 11.8: Dotplot of the line matching dataset
</p>
</div>
<p>however, since the data represent positive or negative displacements from zero, it would be nice to add a horizontal line passing from zero. In order to have this, we will write a panel function that combines the <code>panel.dotplot</code> function with the <code>panel.abline</code> function that we’ll use to add the horizontal line:</p>
<pre class="sourceCode r"><code class="sourceCode r">panel.hRefDotplot &lt;-<span class="st"> </span>function(x, y, <span class="dt">ref=</span><span class="ot">NULL</span>, ...){
<span class="kw">panel.dotplot</span>(x, y, ...)
<span class="kw">panel.abline</span>(<span class="dt">h=</span>ref, ...)
}</code></pre>
<p>our new <code>panel.hRefDotplot</code> panel function accepts three arguments, <code>x</code> and <code>y</code>, which are the “standard” arguments given by the higher level plotting functions like <code>dotplot</code> to panel functions to specify the data to draw. The third argument represents the position at which to draw the horizontal line of reference for the data, we want it to be zero in this case, but passing the argument as a variable rather than hard-coding the value into the panel function will allow us to recycle this panel function in case we want the horizontal reference line drawn at some other points in the future. Besides these arguments, our panel function accepts also an undefined number of other arguments, which are designated by the <code>...</code> notation. These are usually graphics parameters that can be specified in the high level plotting function. The contents of our <code>panel.hRefDotplot</code> function are very simple, we call first <code>panel.dotplot</code> to draw the standard dotplot, and then we call <code>panel.abline</code> giving it the value of <code>ref</code> to draw the horizontal line in each panel. The actual plot is done by calling the high level <code>dotplot</code> function specifying <code>panel.hRefDotplot</code> as the panel function to use:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dotplot</span>(error ~<span class="st"> </span>length |<span class="st"> </span>group, <span class="dt">groups=</span>color, 
        <span class="dt">data=</span>dats, <span class="dt">origin=</span><span class="dv">0</span>, <span class="dt">ylab=</span><span class="st">&quot;Error (cm)&quot;</span>, 
        <span class="dt">xlab=</span><span class="st">&quot;Segment Length&quot;</span>, <span class="dt">auto.key=</span><span class="ot">TRUE</span>, <span class="dt">aspect=</span><span class="dv">1</span>, 
        <span class="dt">as.table=</span><span class="ot">TRUE</span>, <span class="dt">ref=</span><span class="dv">0</span>, <span class="dt">panel=</span>panel.hRefDotplot)</code></pre>
<div class="figure"><span id="fig:lmatchdotplotref"></span>
<img src="graphics_lattice_files/figure-html/lmatchdotplotref-1.png" alt="Dotplot of the line matching dataset, with horizontal reference line" width="672" />
<p class="caption">
Figure 11.9: Dotplot of the line matching dataset, with horizontal reference line
</p>
</div>
<p>notice the last line of the call, first we’re telling <code>dotplot</code> to use our <code>hRefDotplot</code> function to do the plotting by specifying the <code>panel</code> argument, second we’re specifying another argument, <code>ref</code> in the call, this is not a standard argument, but it will be automatically passed to our panel function to decide at which height to draw the horizontal line. The resulting plot can be visualised in Figure <a href="trellis.html#fig:lmatchdotplotref">11.9</a>.</p>


</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotly.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="probability-distribution-functions.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sam81/rguide/edit/master/graphics_lattice.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
