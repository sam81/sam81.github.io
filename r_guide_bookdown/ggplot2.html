<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 ggplot2 | A R Guide</title>
  <meta name="description" content="A guide for the R programming language." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="9 ggplot2 | A R Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide for the R programming language." />
  <meta name="github-repo" content="sam81/rguide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 ggplot2 | A R Guide" />
  
  <meta name="twitter:description" content="A guide for the R programming language." />
  

<meta name="author" content="Samuele Carcagno" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fonts.html"/>
<link rel="next" href="plotly.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./preface.html">A R Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#installing-the-base-program"><i class="fa fa-check"></i><b>1.1</b> Installing the Base Program</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices"><i class="fa fa-check"></i><b>1.1.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#windows"><i class="fa fa-check"></i><b>1.1.2</b> Windows</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#mac-os-x"><i class="fa fa-check"></i><b>1.1.3</b> Mac Os X</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installing-add-on-packages"><i class="fa fa-check"></i><b>1.2</b> Installing Add-On Packages</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices-1"><i class="fa fa-check"></i><b>1.2.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#windows-1"><i class="fa fa-check"></i><b>1.2.2</b> Windows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> A Simple Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#datasets"><i class="fa fa-check"></i><b>2.1</b> Datasets</a></li>
<li class="chapter" data-level="2.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#firing-up-and-quitting-r"><i class="fa fa-check"></i><b>2.2</b> Firing up and Quitting R</a></li>
<li class="chapter" data-level="2.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#starting-to-work-with-r"><i class="fa fa-check"></i><b>2.3</b> Starting to Work with R</a></li>
<li class="chapter" data-level="2.4" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#gettinghelp"><i class="fa fa-check"></i><b>2.4</b> Getting Help</a><ul>
<li class="chapter" data-level="2.4.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-online-help-system"><i class="fa fa-check"></i><b>2.4.1</b> The Online Help System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#gui"><i class="fa fa-check"></i><b>2.5</b> Working with a Graphical User Interface</a><ul>
<li class="chapter" data-level="2.5.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#r-studio"><i class="fa fa-check"></i><b>2.5.1</b> R Studio</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-r-commander"><i class="fa fa-check"></i><b>2.5.2</b> The R Commander</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#jgr"><i class="fa fa-check"></i><b>2.5.3</b> JGR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html"><i class="fa fa-check"></i><b>3</b> Organising a Working Session</a><ul>
<li class="chapter" data-level="3.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#setting-and-changing-the-working-directory"><i class="fa fa-check"></i><b>3.1</b> Setting and Changing the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#objects"><i class="fa fa-check"></i><b>3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#saving-and-using-the-workspace-image"><i class="fa fa-check"></i><b>3.3</b> Saving and Using the “Workspace Image”</a></li>
<li class="chapter" data-level="3.4" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#working-in-batch-mode"><i class="fa fa-check"></i><b>3.4</b> Working in Batch Mode</a><ul>
<li class="chapter" data-level="3.4.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-an-r-session"><i class="fa fa-check"></i><b>3.4.1</b> Executing commands written in a file from an R session</a></li>
<li class="chapter" data-level="3.4.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-a-shell"><i class="fa fa-check"></i><b>3.4.2</b> Executing commands written in a file from a shell</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datamanip.html"><a href="datamanip.html"><i class="fa fa-check"></i><b>4</b> Data Types and Data Manipulation</a><ul>
<li class="chapter" data-level="4.1" data-path="datamanip.html"><a href="datamanip.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="datamanip.html"><a href="datamanip.html#indexing-vectors"><i class="fa fa-check"></i><b>4.2</b> Indexing Vectors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="datamanip.html"><a href="datamanip.html#the-seq-function"><i class="fa fa-check"></i><b>4.2.1</b> The <code>seq</code> Function</a></li>
<li class="chapter" data-level="4.2.2" data-path="datamanip.html"><a href="datamanip.html#the-rep-function"><i class="fa fa-check"></i><b>4.2.2</b> The <code>rep</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="datamanip.html"><a href="datamanip.html#matrix-facilities"><i class="fa fa-check"></i><b>4.3</b> Matrix Facilities</a><ul>
<li class="chapter" data-level="4.3.1" data-path="datamanip.html"><a href="datamanip.html#matrix-operations"><i class="fa fa-check"></i><b>4.3.1</b> Matrix Operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="datamanip.html"><a href="datamanip.html#Lists"><i class="fa fa-check"></i><b>4.4</b> Lists</a></li>
<li class="chapter" data-level="4.5" data-path="datamanip.html"><a href="datamanip.html#dataframes"><i class="fa fa-check"></i><b>4.5</b> Dataframes</a><ul>
<li class="chapter" data-level="4.5.1" data-path="datamanip.html"><a href="datamanip.html#accessing-parts-of-a-dataframe"><i class="fa fa-check"></i><b>4.5.1</b> Accessing Parts of a Dataframe</a></li>
<li class="chapter" data-level="4.5.2" data-path="datamanip.html"><a href="datamanip.html#change-the-names-of-variables-in-a-dataframe"><i class="fa fa-check"></i><b>4.5.2</b> Change the Names of Variables in a Dataframe</a></li>
<li class="chapter" data-level="4.5.3" data-path="datamanip.html"><a href="datamanip.html#other-ways-to-subset-a-dataframe"><i class="fa fa-check"></i><b>4.5.3</b> Other Ways to Subset a Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="datamanip.html"><a href="datamanip.html#factors"><i class="fa fa-check"></i><b>4.6</b> Factors</a><ul>
<li class="chapter" data-level="4.6.1" data-path="datamanip.html"><a href="datamanip.html#renaming-the-levels-of-a-factor"><i class="fa fa-check"></i><b>4.6.1</b> Renaming the levels of a factor</a></li>
<li class="chapter" data-level="4.6.2" data-path="datamanip.html"><a href="datamanip.html#gl"><i class="fa fa-check"></i><b>4.6.2</b> Creating Factors with <code>gl</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="datamanip.html"><a href="datamanip.html#natural-sort-order-for-character-and-factor-vectors"><i class="fa fa-check"></i><b>4.6.3</b> Natural sort order for character and factor vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="datamanip.html"><a href="datamanip.html#getting-info-on-r-objects"><i class="fa fa-check"></i><b>4.7</b> Getting Info on R Objects</a></li>
<li class="chapter" data-level="4.8" data-path="datamanip.html"><a href="datamanip.html#changing-the-format-of-your-data"><i class="fa fa-check"></i><b>4.8</b> Changing the Format of Your Data</a><ul>
<li class="chapter" data-level="4.8.1" data-path="datamanip.html"><a href="datamanip.html#the-one-row-per-observation-format"><i class="fa fa-check"></i><b>4.8.1</b> The “One Row per Observation” Format</a></li>
<li class="chapter" data-level="4.8.2" data-path="datamanip.html"><a href="datamanip.html#stack"><i class="fa fa-check"></i><b>4.8.2</b> The <code>stack</code> and <code>unstack</code> functions</a></li>
<li class="chapter" data-level="4.8.3" data-path="datamanip.html"><a href="datamanip.html#tapply"><i class="fa fa-check"></i><b>4.8.3</b> The <code>tapply</code> and <code>aggregate</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="datamanip.html"><a href="datamanip.html#the-scale-function"><i class="fa fa-check"></i><b>4.9</b> The <code>scale</code> Function</a></li>
<li class="chapter" data-level="4.10" data-path="datamanip.html"><a href="datamanip.html#creating-and-editing-data-objects-through-a-visual-interface"><i class="fa fa-check"></i><b>4.10</b> Creating and Editing Data Objects through a Visual Interface</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualising-your-data.html"><a href="visualising-your-data.html"><i class="fa fa-check"></i><b>5</b> Visualising Your Data</a><ul>
<li class="chapter" data-level="5.1" data-path="visualising-your-data.html"><a href="visualising-your-data.html#reading-numbers-in-exponential-notation"><i class="fa fa-check"></i><b>5.1</b> Reading Numbers in Exponential Notation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="IO.html"><a href="IO.html"><i class="fa fa-check"></i><b>6</b> File Input/Output</a><ul>
<li class="chapter" data-level="6.1" data-path="IO.html"><a href="IO.html#reading-in-data-from-a-file"><i class="fa fa-check"></i><b>6.1</b> Reading In Data from a File</a><ul>
<li class="chapter" data-level="6.1.1" data-path="IO.html"><a href="IO.html#read.table"><i class="fa fa-check"></i><b>6.1.1</b> The <code>read.table</code> function</a></li>
<li class="chapter" data-level="6.1.2" data-path="IO.html"><a href="IO.html#scan"><i class="fa fa-check"></i><b>6.1.2</b> <code>scan</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="IO.html"><a href="IO.html#low-level-file-input"><i class="fa fa-check"></i><b>6.1.3</b> Low-Level File Input</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="IO.html"><a href="IO.html#writing-data-to-a-file"><i class="fa fa-check"></i><b>6.2</b> Writing data to a file</a><ul>
<li class="chapter" data-level="6.2.1" data-path="IO.html"><a href="IO.html#write.table"><i class="fa fa-check"></i><b>6.2.1</b> The <code>write.table</code> function</a></li>
<li class="chapter" data-level="6.2.2" data-path="IO.html"><a href="IO.html#saving-objecs-in-binary-format"><i class="fa fa-check"></i><b>6.2.2</b> Saving objecs in binary format</a></li>
<li class="chapter" data-level="6.2.3" data-path="IO.html"><a href="IO.html#cat"><i class="fa fa-check"></i><b>6.2.3</b> Low-Level File Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>7</b> Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="graphics.html"><a href="graphics.html#overview-of-r-base-graphics-functions"><i class="fa fa-check"></i><b>7.1</b> Overview of R base graphics functions</a></li>
<li class="chapter" data-level="7.2" data-path="graphics.html"><a href="graphics.html#plot"><i class="fa fa-check"></i><b>7.2</b> The <code>plot</code> Function</a></li>
<li class="chapter" data-level="7.3" data-path="graphics.html"><a href="graphics.html#drawing-functions"><i class="fa fa-check"></i><b>7.3</b> Drawing Functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="graphics.html"><a href="graphics.html#the-matplot-function"><i class="fa fa-check"></i><b>7.3.1</b> The <code>matplot</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="graphics.html"><a href="graphics.html#barplots"><i class="fa fa-check"></i><b>7.4</b> Barplots</a><ul>
<li class="chapter" data-level="7.4.1" data-path="graphics.html"><a href="graphics.html#barplots-with-error-bars"><i class="fa fa-check"></i><b>7.4.1</b> Barplots with Error Bars</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>7.6</b> Histograms</a></li>
<li class="chapter" data-level="7.7" data-path="graphics.html"><a href="graphics.html#stripcharts"><i class="fa fa-check"></i><b>7.7</b> Stripcharts</a></li>
<li class="chapter" data-level="7.8" data-path="graphics.html"><a href="graphics.html#interaction-plots"><i class="fa fa-check"></i><b>7.8</b> Interaction Plots</a></li>
<li class="chapter" data-level="7.9" data-path="graphics.html"><a href="graphics.html#par"><i class="fa fa-check"></i><b>7.9</b> Setting Graphics Parameters</a><ul>
<li class="chapter" data-level="7.9.1" data-path="graphics.html"><a href="graphics.html#saving-and-restoring-graphics-parameters"><i class="fa fa-check"></i><b>7.9.1</b> Saving and Restoring Graphics Parameters</a></li>
<li class="chapter" data-level="7.9.2" data-path="graphics.html"><a href="graphics.html#lty"><i class="fa fa-check"></i><b>7.9.2</b> Line type with the <code>lty</code> parameter</a></li>
<li class="chapter" data-level="7.9.3" data-path="graphics.html"><a href="graphics.html#secpch"><i class="fa fa-check"></i><b>7.9.3</b> Symbols with the <code>pch</code> parameter</a></li>
<li class="chapter" data-level="7.9.4" data-path="graphics.html"><a href="graphics.html#parfonts"><i class="fa fa-check"></i><b>7.9.4</b> Fonts</a></li>
<li class="chapter" data-level="7.9.5" data-path="graphics.html"><a href="graphics.html#parcolors"><i class="fa fa-check"></i><b>7.9.5</b> Colors</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="graphics.html"><a href="graphics.html#adding-elements-to-a-plot"><i class="fa fa-check"></i><b>7.10</b> Adding Elements to a Plot</a><ul>
<li class="chapter" data-level="7.10.1" data-path="graphics.html"><a href="graphics.html#legend"><i class="fa fa-check"></i><b>7.10.1</b> Adding a Legend</a></li>
<li class="chapter" data-level="7.10.2" data-path="graphics.html"><a href="graphics.html#adding-text"><i class="fa fa-check"></i><b>7.10.2</b> Adding Text</a></li>
<li class="chapter" data-level="7.10.3" data-path="graphics.html"><a href="graphics.html#addgrid"><i class="fa fa-check"></i><b>7.10.3</b> Adding a Grid</a></li>
<li class="chapter" data-level="7.10.4" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>7.10.4</b> Setting the Axes</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="graphics.html"><a href="graphics.html#glayout"><i class="fa fa-check"></i><b>7.11</b> Creating Layouts for Multiple Graphs</a><ul>
<li class="chapter" data-level="7.11.1" data-path="graphics.html"><a href="graphics.html#mfrow-and-mfcol-mfrowmfcol"><i class="fa fa-check"></i><b>7.11.1</b> mfrow and mfcol {mfrowmfcol}</a></li>
<li class="chapter" data-level="7.11.2" data-path="graphics.html"><a href="graphics.html#layout"><i class="fa fa-check"></i><b>7.11.2</b> layout</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="graphics.html"><a href="graphics.html#graphics-device-regions-and-coordinates"><i class="fa fa-check"></i><b>7.12</b> Graphics Device Regions and Coordinates</a></li>
<li class="chapter" data-level="7.13" data-path="graphics.html"><a href="graphics.html#colours-for-graphics"><i class="fa fa-check"></i><b>7.13</b> Colours for Graphics</a><ul>
<li class="chapter" data-level="7.13.1" data-path="graphics.html"><a href="graphics.html#colour-opacity"><i class="fa fa-check"></i><b>7.13.1</b> Colour Opacity</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="graphics.html"><a href="graphics.html#managing-graphic-devices"><i class="fa fa-check"></i><b>7.14</b> Managing Graphic Devices</a><ul>
<li class="chapter" data-level="7.14.1" data-path="graphics.html"><a href="graphics.html#opening-another-graphics-window"><i class="fa fa-check"></i><b>7.14.1</b> Opening Another Graphics Window</a></li>
<li class="chapter" data-level="7.14.2" data-path="graphics.html"><a href="graphics.html#exporting-graphics"><i class="fa fa-check"></i><b>7.14.2</b> Exporting Graphics</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="graphics.html"><a href="graphics.html#plotmath"><i class="fa fa-check"></i><b>7.15</b> Mathematical expressions and variables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fonts.html"><a href="fonts.html"><i class="fa fa-check"></i><b>8</b> Fonts for graphics</a></li>
<li class="chapter" data-level="9" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>9</b> ggplot2</a><ul>
<li class="chapter" data-level="9.1" data-path="ggplot2.html"><a href="ggplot2.html#common-charts"><i class="fa fa-check"></i><b>9.1</b> Common charts</a><ul>
<li class="chapter" data-level="9.1.1" data-path="ggplot2.html"><a href="ggplot2.html#barplots-1"><i class="fa fa-check"></i><b>9.1.1</b> Barplots</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ggplot2.html"><a href="ggplot2.html#scales"><i class="fa fa-check"></i><b>9.2</b> Scales</a><ul>
<li class="chapter" data-level="9.2.1" data-path="ggplot2.html"><a href="ggplot2.html#log-axis-with-pretty-tickmarks"><i class="fa fa-check"></i><b>9.2.1</b> Log axis with pretty tickmarks</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>9.3</b> Themes</a></li>
<li class="chapter" data-level="9.4" data-path="ggplot2.html"><a href="ggplot2.html#tips-and-tricks"><i class="fa fa-check"></i><b>9.4</b> Tips and tricks</a><ul>
<li class="chapter" data-level="9.4.1" data-path="ggplot2.html"><a href="ggplot2.html#fixing-labels-that-wont-fit"><i class="fa fa-check"></i><b>9.4.1</b> Fixing labels that won’t fit</a></li>
<li class="chapter" data-level="9.4.2" data-path="ggplot2.html"><a href="ggplot2.html#setting-the-aspect-ratio"><i class="fa fa-check"></i><b>9.4.2</b> Setting the aspect ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>10</b> Plotly</a><ul>
<li class="chapter" data-level="10.1" data-path="plotly.html"><a href="plotly.html#using-plotly-with-knitr"><i class="fa fa-check"></i><b>10.1</b> Using plotly with knitr</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lattice.html"><a href="lattice.html"><i class="fa fa-check"></i><b>11</b> Lattice Graphics</a><ul>
<li class="chapter" data-level="11.1" data-path="lattice.html"><a href="lattice.html#overview-of-lattice-graphics"><i class="fa fa-check"></i><b>11.1</b> Overview of Lattice Graphics</a></li>
<li class="chapter" data-level="11.2" data-path="lattice.html"><a href="lattice.html#introduction-to-model-formulae-and-multi-panel-conditioning"><i class="fa fa-check"></i><b>11.2</b> Introduction to model formulae and multi-panel conditioning</a></li>
<li class="chapter" data-level="11.3" data-path="lattice.html"><a href="lattice.html#barchart"><i class="fa fa-check"></i><b>11.3</b> <code>barchart</code></a></li>
<li class="chapter" data-level="11.4" data-path="lattice.html"><a href="lattice.html#histogram"><i class="fa fa-check"></i><b>11.4</b> histogram</a></li>
<li class="chapter" data-level="11.5" data-path="lattice.html"><a href="lattice.html#interaction-plots-1"><i class="fa fa-check"></i><b>11.5</b> Interaction Plots</a></li>
<li class="chapter" data-level="11.6" data-path="lattice.html"><a href="lattice.html#customizingtrellis"><i class="fa fa-check"></i><b>11.6</b> Customising Lattice Graphics</a><ul>
<li class="chapter" data-level="11.6.1" data-path="lattice.html"><a href="lattice.html#textual-elements"><i class="fa fa-check"></i><b>11.6.1</b> Textual Elements</a></li>
<li class="chapter" data-level="11.6.2" data-path="lattice.html"><a href="lattice.html#log-axis-with-pretty-tickmarks-1"><i class="fa fa-check"></i><b>11.6.2</b> Log axis with pretty tickmarks</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="lattice.html"><a href="lattice.html#trellispanel"><i class="fa fa-check"></i><b>11.7</b> Writing Panel Functions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="lattice.html"><a href="lattice.html#combining-panel-functions"><i class="fa fa-check"></i><b>11.7.1</b> Combining Panel Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>12</b> Tidyverse</a><ul>
<li class="chapter" data-level="12.1" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>12.1</b> Tibbles</a></li>
<li class="chapter" data-level="12.2" data-path="tidyverse.html"><a href="tidyverse.html#dplyr"><i class="fa fa-check"></i><b>12.2</b> <code>dplyr</code></a><ul>
<li class="chapter" data-level="12.2.1" data-path="tidyverse.html"><a href="tidyverse.html#group_by-and-summarize"><i class="fa fa-check"></i><b>12.2.1</b> <code>group_by</code> and <code>summarize</code></a></li>
<li class="chapter" data-level="12.2.2" data-path="tidyverse.html"><a href="tidyverse.html#getting-counts-of-cases"><i class="fa fa-check"></i><b>12.2.2</b> Getting counts of cases</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html"><i class="fa fa-check"></i><b>13</b> Probability Distribution Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#bernoulli"><i class="fa fa-check"></i><b>13.1</b> The Bernoulli distribution</a></li>
<li class="chapter" data-level="13.2" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#binomial"><i class="fa fa-check"></i><b>13.2</b> The binomial distribution</a></li>
<li class="chapter" data-level="13.3" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#normal"><i class="fa fa-check"></i><b>13.3</b> The normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>14</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="14.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi2-test"><i class="fa fa-check"></i><b>14.1</b> <span class="math inline">\(\chi^2\)</span> test</a><ul>
<li class="chapter" data-level="14.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-hypotheses-about-the-distribution-of-a-categorical-variable"><i class="fa fa-check"></i><b>14.1.1</b> Testing Hypotheses about the Distribution of a Categorical Variable</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#students-t-test"><i class="fa fa-check"></i><b>14.2</b> Student’s <em>t</em> test</a><ul>
<li class="chapter" data-level="14.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>14.2.1</b> One sample <em>t</em>-test</a></li>
<li class="chapter" data-level="14.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-samples-t-test"><i class="fa fa-check"></i><b>14.2.2</b> Two samples t-test</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-levene-test-for-homogeneity-of-variances"><i class="fa fa-check"></i><b>14.3</b> The Levene Test for Homogeneity of Variances</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>15</b> Correlation and Regression</a><ul>
<li class="chapter" data-level="15.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#linear-regression"><i class="fa fa-check"></i><b>15.1</b> Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>16</b> ANOVA</a><ul>
<li class="chapter" data-level="16.1" data-path="anova.html"><a href="anova.html#one-way-anova"><i class="fa fa-check"></i><b>16.1</b> One-Way ANOVA</a></li>
<li class="chapter" data-level="16.2" data-path="anova.html"><a href="anova.html#repeated-measures-anova"><i class="fa fa-check"></i><b>16.2</b> Repeated Measures ANOVA</a><ul>
<li class="chapter" data-level="16.2.1" data-path="anova.html"><a href="anova.html#one-within-subjects-factor"><i class="fa fa-check"></i><b>16.2.1</b> One Within Subjects Factor</a></li>
<li class="chapter" data-level="16.2.2" data-path="anova.html"><a href="anova.html#two-within-subjects-factors"><i class="fa fa-check"></i><b>16.2.2</b> Two Within Subjects Factors</a></li>
<li class="chapter" data-level="16.2.3" data-path="anova.html"><a href="anova.html#two-within-subjects-factors-and-one-between"><i class="fa fa-check"></i><b>16.2.3</b> Two Within Subjects Factors and One Between</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="adjusting-the-p-values-for-multiple-comparisons.html"><a href="adjusting-the-p-values-for-multiple-comparisons.html"><i class="fa fa-check"></i><b>17</b> Adjusting the <em>p</em>-values for Multiple Comparisons</a></li>
<li class="chapter" data-level="18" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>18</b> R Programming</a><ul>
<li class="chapter" data-level="18.1" data-path="programming.html"><a href="programming.html#contrstruct"><i class="fa fa-check"></i><b>18.1</b> Control Structures</a></li>
<li class="chapter" data-level="18.2" data-path="programming.html"><a href="programming.html#stringprocessing"><i class="fa fa-check"></i><b>18.2</b> String Processing</a><ul>
<li class="chapter" data-level="18.2.1" data-path="programming.html"><a href="programming.html#regexp"><i class="fa fa-check"></i><b>18.2.1</b> Using Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="programming.html"><a href="programming.html#tips-and-tricks-1"><i class="fa fa-check"></i><b>18.3</b> Tips and Tricks</a><ul>
<li class="chapter" data-level="18.3.1" data-path="programming.html"><a href="programming.html#convert-a-string-into-a-command"><i class="fa fa-check"></i><b>18.3.1</b> Convert a String into a Command</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="programming.html"><a href="programming.html#creatingsimplerpackages"><i class="fa fa-check"></i><b>18.4</b> Creating Simple R Packages</a><ul>
<li class="chapter" data-level="18.4.1" data-path="programming.html"><a href="programming.html#the-bare-minimum-to-create-a-package"><i class="fa fa-check"></i><b>18.4.1</b> The Bare Minimum to Create a Package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="custom.html"><a href="custom.html"><i class="fa fa-check"></i><b>19</b> Environment Customisation</a></li>
<li class="chapter" data-level="20" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html"><i class="fa fa-check"></i><b>20</b> ESS: Using Emacs Speaks Statistics with R</a><ul>
<li class="chapter" data-level="20.1" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-for-editing-and-debugging-r-source-files"><i class="fa fa-check"></i><b>20.1</b> Using ESS for Editing and Debugging R Source Files</a></li>
<li class="chapter" data-level="20.2" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-to-interact-with-a-r-process"><i class="fa fa-check"></i><b>20.2</b> Using ESS to Interact with a R Process</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html"><i class="fa fa-check"></i><b>21</b> Using Sweave to Write Documents with R and LaTeX</a><ul>
<li class="chapter" data-level="21.1" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#whats-sweave"><i class="fa fa-check"></i><b>21.1</b> What’s Sweave?</a></li>
<li class="chapter" data-level="21.2" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#usage"><i class="fa fa-check"></i><b>21.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="soundprocessing.html"><a href="soundprocessing.html"><i class="fa fa-check"></i><b>22</b> Sound Processing</a><ul>
<li class="chapter" data-level="22.1" data-path="soundprocessing.html"><a href="soundprocessing.html#libraries-for-sound-analysis-and-signal-processing"><i class="fa fa-check"></i><b>22.1</b> Libraries for Sound Analysis and Signal Processing</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html"><i class="fa fa-check"></i><b>A</b> Partial List of Packages by Category</a><ul>
<li class="chapter" data-level="A.1" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#graphics-packages"><i class="fa fa-check"></i><b>A.1</b> Graphics Packages</a></li>
<li class="chapter" data-level="A.2" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#gui-packages"><i class="fa fa-check"></i><b>A.2</b> GUI Packages</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="miscellaneous-commands.html"><a href="miscellaneous-commands.html"><i class="fa fa-check"></i><b>B</b> Miscellaneous commands</a></li>
<li class="chapter" data-level="C" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html"><i class="fa fa-check"></i><b>C</b> Other Manuals and Sources of Information on R</a><ul>
<li class="chapter" data-level="C.0.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian"><i class="fa fa-check"></i><b>C.0.1</b> In Italian</a></li>
<li class="chapter" data-level="C.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#other-useful-statistics-resources"><i class="fa fa-check"></i><b>C.1</b> Other useful statistics resources</a><ul>
<li class="chapter" data-level="C.1.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian-1"><i class="fa fa-check"></i><b>C.1.1</b> In Italian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="fullcoltable.html"><a href="fullcoltable.html"><i class="fa fa-check"></i><b>D</b> Full Colours Table</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A R Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1">
<h1><span class="header-section-number">9</span> ggplot2</h1>
<p>The book “ggplot2. Elegant graphics for data analysis” <span class="citation">(Wickham <a href="#ref-Wickham2009">2009</a>)</span> is the best reference for learning ggplot2</p>
<p>Other useful resources include:</p>
<ul>
<li>AVML 2012: ggplot2 <a href="http://www.ling.upenn.edu/~joseff/avml2012/" class="uri">http://www.ling.upenn.edu/~joseff/avml2012/</a> by
Josef Fruehwald. This is one of the best introductions to ggplot2,
highly recommended! There is a more recent version of this tutorial
also here: <a href="http://jofrhwld.github.io/teaching/courses/2017_lvc/practicals/7_practical_r.html#inheritance" class="uri">http://jofrhwld.github.io/teaching/courses/2017_lvc/practicals/7_practical_r.html#inheritance</a></li>
</ul>
<p>All the examples in this chapter assume that ggplot2 has been
installed and is loaded in your R session. If not, you can install it with:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</a></code></pre></div>
<p>and load it with:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>At its essence a plot is a mapping of certain properties of the data to certain visual properties of the medium (paper, screen, etc…) on which it appears. For example, a variable such as blood pressure, may be mapped to the coordinate of a point in the y axis, and another variable such as time, may be mapped to the coordinate of a point on the x axis. Sometimes variables may be mapped to other graphical aspects, such as the color of points, the type (solid, dashed, etc…) of a line, or the size of a point. ggplot2 implements a “grammar” of graphics that allows you to express and control this mappings with a high-level language. Compared to traditional plotting systems (such as base R graphics) this typically allows you to express these mappings concisely; if you master the grammar it may also allow to do it more quickly.</p>
<p>Two basic elements of ggplot2 are “aesthetics”, and “geometries”. Aesthetics in ggplot2 define the ways in which data properties are conceptually mapped to graphical elements (e.g. by position, color, shape, etc…). Geometries, on the other hand, represent the actual geometrical elements (e.g. points, lines, bars, etc…) used to implement these mappings. Let’s move on to some examples to clarify this. We’ll first simulate a dataset containing the measured height, width, and weight of some objects:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="kw">set.seed</span>(<span class="dv">790</span>); n =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb310-2" title="2">height =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb310-3" title="3">width =<span class="st"> </span>height <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">2.2</span>)</a>
<a class="sourceLine" id="cb310-4" title="4">weight =<span class="st"> </span>(width<span class="op">+</span>height)<span class="op">/</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb310-5" title="5">dat =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">height=</span>height, <span class="dt">weight=</span>weight, <span class="dt">width=</span>width)</a></code></pre></div>
<p>we can visualize the width and height data, and their relation, by mapping width to position on the x axis, and height to position on the y axis, then use points to implement these mapping. In ggplots we would write:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data=</span>dat, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>width, <span class="dt">y=</span>height)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-4-1.png" alt="Width and height of some objects" width="326.4" />
<p class="caption">
Figure 9.1: Width and height of some objects
</p>
</div>
<p>note how the <code>ggplot</code> function takes two arguments, <code>data</code> must be a dataframe holding the variables of interest; the <code>mapping</code> argument takes a function called <code>aes</code> that specifies the aesthetic mappings. The geometry is “added” later with the <code>+</code> operator. From now on we will omit for brevity the argument names and simply write:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>width, <span class="dt">y=</span>height)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p>one way to map the weight data onto the current graph could be to set the size of the points depending on the weight value:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>width, <span class="dt">y=</span>height, <span class="dt">size=</span>weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-6"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-6-1.png" alt="Width and height of some objects" width="326.4" />
<p class="caption">
Figure 9.2: Width and height of some objects
</p>
</div>
<p>yet another way could be to set the color of the points depending on the weight value:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>width, <span class="dt">y=</span>height, <span class="dt">color=</span>weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-7"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-7-1.png" alt="Width and height of some objects" width="326.4" />
<p class="caption">
Figure 9.3: Width and height of some objects
</p>
</div>
<p>for this last plot we may want to increase the size of <em>all</em> points to make their color easier to see. We can do this by passing a <code>size</code> argument to <code>geom_point</code>:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>width, <span class="dt">y=</span>height, <span class="dt">color=</span>weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-8-1.png" alt="Width and height of some objects" width="326.4" />
<p class="caption">
Figure 9.4: Width and height of some objects
</p>
</div>
<p>although by doing this we are modifying an aesthetic quality of the plot, this does not generate an <em>aesthetic mapping</em> between the data and the graphic in the sense of the grammar of graphics. Aesthetic mappings always go within an <code>aes</code> call, while changes of the visual properties of the data that are not aesthetic mappings go outside it.</p>
<div id="common-charts" class="section level2">
<h2><span class="header-section-number">9.1</span> Common charts</h2>
<div id="barplots-1" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Barplots</h3>
<p>Barplots can be obtained with <code>geom_col</code>. We’ll first generate a dataset with three factors to use for the examples:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1714</span>)</a>
<a class="sourceLine" id="cb316-2" title="2">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean=</span><span class="dv">2</span>, <span class="dt">sd=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb316-3" title="3">fac1 =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;C1&quot;</span>, <span class="st">&quot;C2&quot;</span>), <span class="dt">each=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb316-4" title="4">fac2 =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;D1&quot;</span>, <span class="st">&quot;D2&quot;</span>), <span class="dt">each=</span><span class="dv">5</span>), <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb316-5" title="5">fac3 =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;E1&quot;</span>, <span class="st">&quot;E2&quot;</span>), <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb316-6" title="6">dd =<span class="st"> </span><span class="kw">data.frame</span>(y, fac1, fac2, fac3)</a></code></pre></div>
<p>next we’ll summarize <code>y</code> by one, two, or all three factors:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1">ddSumm1 =<span class="st"> </span>dd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(fac1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mny=</span><span class="kw">mean</span>(y),</a>
<a class="sourceLine" id="cb317-2" title="2">                                              <span class="dt">sdy=</span><span class="kw">sd</span>(y))</a>
<a class="sourceLine" id="cb317-3" title="3">ddSumm2 =<span class="st"> </span>dd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(fac1, fac2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mny=</span><span class="kw">mean</span>(y),</a>
<a class="sourceLine" id="cb317-4" title="4">                                                    <span class="dt">sdy=</span><span class="kw">sd</span>(y))</a>
<a class="sourceLine" id="cb317-5" title="5">ddSumm3 =<span class="st"> </span>dd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(fac1, fac2, fac3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mny=</span><span class="kw">mean</span>(y),</a>
<a class="sourceLine" id="cb317-6" title="6">                                                          <span class="dt">sdy=</span><span class="kw">sd</span>(y))</a></code></pre></div>
<p>the simplest barplot is the one showing the mean value of <code>y</code> as a function of <code>fac1</code> alone:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1">p1 =<span class="st"> </span><span class="kw">ggplot</span>(ddSumm1, <span class="kw">aes</span>(fac1, mny))</a>
<a class="sourceLine" id="cb318-2" title="2">p1 =<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>()</a>
<a class="sourceLine" id="cb318-3" title="3">p1</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="326.4" /></p>
<p>we can add error bars wth <code>geom_errorbar</code>:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1">p1 =<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>mny<span class="op">-</span>sdy, <span class="dt">ymax=</span>mny<span class="op">+</span>sdy),</a>
<a class="sourceLine" id="cb319-2" title="2">                        <span class="dt">width=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb319-3" title="3">p1</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="326.4" /></p>
<p>next we’ll plot <code>y</code> as a function of both <code>fac1</code> and <code>fac2</code>, by using the <code>fill</code> aesthetic to map <code>fac2</code> to the color of the bars:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1">p2 =<span class="st"> </span><span class="kw">ggplot</span>(ddSumm2, <span class="kw">aes</span>(fac1, mny, <span class="dt">fill=</span>fac2))</a>
<a class="sourceLine" id="cb320-2" title="2">p2 =<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>()</a>
<a class="sourceLine" id="cb320-3" title="3">p2</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="326.4" /></p>
<p>the code above generates a stacked barplot. To generate a barplot with the bars side to side rather than stacked we have to use <code>position_dodge</code> to offset the position of the bars relative to each other:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1">dodge_size=<span class="fl">0.9</span></a>
<a class="sourceLine" id="cb321-2" title="2">p2 =<span class="st"> </span><span class="kw">ggplot</span>(ddSumm2, <span class="kw">aes</span>(fac1, mny, <span class="dt">fill=</span>fac2))</a>
<a class="sourceLine" id="cb321-3" title="3">p2 =<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(dodge_size))</a>
<a class="sourceLine" id="cb321-4" title="4">p2 =<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>mny<span class="op">-</span>sdy, <span class="dt">ymax=</span>mny<span class="op">+</span>sdy),</a>
<a class="sourceLine" id="cb321-5" title="5">                        <span class="dt">width=</span><span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb321-6" title="6">                        <span class="dt">position=</span><span class="kw">position_dodge</span>(dodge_size))</a>
<a class="sourceLine" id="cb321-7" title="7">p2 =<span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">name=</span><span class="st">&quot;Fac. #2&quot;</span>, <span class="dt">values=</span><span class="kw">palette</span>()[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)])</a>
<a class="sourceLine" id="cb321-8" title="8">p2</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="326.4" /></p>
<p>again we’ve added some error bars; note how we need to set the <code>position</code> argument also for <code>geom_errorbar</code> to make sure the error bars are aligned to the bars of the barplot. We’ve also changed the colors of the bars with <code>scale_fill_manual</code>.</p>
<p>If we have want to map all three factors to the barplot we can plot <code>fac3</code> along different panels using <code>geom_wrap</code>:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1">dodge_size=<span class="fl">0.9</span></a>
<a class="sourceLine" id="cb322-2" title="2">p3 =<span class="st"> </span><span class="kw">ggplot</span>(ddSumm3, <span class="kw">aes</span>(fac1, mny, <span class="dt">fill=</span>fac2))</a>
<a class="sourceLine" id="cb322-3" title="3">p3 =<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(dodge_size))</a>
<a class="sourceLine" id="cb322-4" title="4">p3 =<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>fac3)</a>
<a class="sourceLine" id="cb322-5" title="5">p3 =<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>mny<span class="op">-</span>sdy, <span class="dt">ymax=</span>mny<span class="op">+</span>sdy),</a>
<a class="sourceLine" id="cb322-6" title="6">                        <span class="dt">width=</span><span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb322-7" title="7">                        <span class="dt">position=</span><span class="kw">position_dodge</span>(dodge_size))</a>
<a class="sourceLine" id="cb322-8" title="8">p3 =<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">name=</span><span class="st">&quot;Fac. #2&quot;</span>, <span class="dt">values=</span><span class="kw">palette</span>()[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)])</a>
<a class="sourceLine" id="cb322-9" title="9">p3</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="326.4" /></p>
<p>Besides <code>geom_col</code> there is a <code>geom_bar</code> that can generate barplots; <code>geom_bar(stat="identity)"</code> will produce the same plot as <code>geom_col</code>, however, the default <code>stat</code> for <code>geom_bar</code> is <code>count</code>, so it will plot the count of cases of a certain factor. For example the following chart will plot the number of cars for each manufacturer in the <code>mpg</code> dataset:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1">p =<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()</a>
<a class="sourceLine" id="cb323-2" title="2">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb323-3" title="3">p</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="326.4" /></p>
<p>and the following one will count the number of cars by manufacturer and type of transmission:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1">p =<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer, <span class="dt">fill=</span>trans)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb324-2" title="2">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb324-3" title="3">p</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="432" /></p>
</div>
</div>
<div id="scales" class="section level2">
<h2><span class="header-section-number">9.2</span> Scales</h2>
<div id="log-axis-with-pretty-tickmarks" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Log axis with pretty tickmarks</h3>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">x =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cnd1&quot;</span>, <span class="st">&quot;cnd2&quot;</span>)</a>
<a class="sourceLine" id="cb325-2" title="2">y =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.4</span>, <span class="dv">80</span>)</a>
<a class="sourceLine" id="cb325-3" title="3"></a>
<a class="sourceLine" id="cb325-4" title="4">dat =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)</a>
<a class="sourceLine" id="cb325-5" title="5"></a>
<a class="sourceLine" id="cb325-6" title="6">p =<span class="st"> </span><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb325-7" title="7">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&quot;log10&quot;</span>)</a>
<a class="sourceLine" id="cb325-8" title="8">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">annotation_logticks</span>(<span class="dt">sides=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb325-9" title="9">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>(<span class="dt">base_size=</span><span class="dv">12</span>)</a>
<a class="sourceLine" id="cb325-10" title="10">p</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-18"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-18-1.png" alt="Log axis with pretty tickmarks" width="326.4" />
<p class="caption">
Figure 9.5: Log axis with pretty tickmarks
</p>
</div>
</div>
</div>
<div id="themes" class="section level2">
<h2><span class="header-section-number">9.3</span> Themes</h2>
<p><code>ggplot2</code> ships with a number of themes included. The <a href="https://cran.r-project.org/web/packages/ggthemes/index.html"><code>ggthemes</code></a> package provides a number of additional themes.</p>
</div>
<div id="tips-and-tricks" class="section level2">
<h2><span class="header-section-number">9.4</span> Tips and tricks</h2>
<div id="fixing-labels-that-wont-fit" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Fixing labels that won’t fit</h3>
<p>Sometimes an axis label may be clipped off as in the next example:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1"><span class="kw">set.seed</span>(<span class="dv">260420</span>)</a>
<a class="sourceLine" id="cb326-2" title="2">y=<span class="kw">rnorm</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb326-3" title="3">dd =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="st">&quot;Effect of first condition A&quot;</span>,</a>
<a class="sourceLine" id="cb326-4" title="4">                    <span class="st">&quot;Effect condition B&quot;</span>,</a>
<a class="sourceLine" id="cb326-5" title="5">                    <span class="st">&quot;Effect condition C&quot;</span>),</a>
<a class="sourceLine" id="cb326-6" title="6">                <span class="dt">y=</span>y, <span class="dt">lower=</span>y<span class="op">-</span><span class="kw">runif</span>(<span class="dv">3</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb326-7" title="7">                <span class="dt">upper=</span>y<span class="op">+</span><span class="kw">runif</span>(<span class="dv">3</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb326-8" title="8">p =<span class="st"> </span><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(x,y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb326-9" title="9">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lower, <span class="dt">ymax=</span>upper), <span class="dt">width=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb326-10" title="10">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb326-11" title="11">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;A really long label that won&#39;t easily fit!&quot;</span>)</a>
<a class="sourceLine" id="cb326-12" title="12">p</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-19"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-19-1.png" alt="Example of axis label tha doesn't fit" width="276.0192" />
<p class="caption">
Figure 9.6: Example of axis label tha doesn’t fit
</p>
</div>
<p>the label can be shifted by changing the value of <code>hjust</code> for the <code>element_text</code> or the <code>axis.title.x</code>:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb327-2" title="2">p</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-20"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-20-1.png" alt="Fitting a long label with `hjust`" width="276.0192" />
<p class="caption">
Figure 9.7: Fitting a long label with <code>hjust</code>
</p>
</div>
<p>alternatively we can use the <code>draw_label</code> function from the <code>cowplot</code> package to fine tune the label position:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb328-2" title="2">p =<span class="st"> </span><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(x,y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb328-3" title="3">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>lower, <span class="dt">ymax=</span>upper), <span class="dt">width=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb328-4" title="4">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb328-5" title="5">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb328-6" title="6">p =<span class="st"> </span><span class="kw">ggdraw</span>(p) <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="st">&quot;A really long label that won&#39;t easily fit!&quot;</span>,</a>
<a class="sourceLine" id="cb328-7" title="7">                           <span class="dt">x =</span> <span class="fl">0.025</span>, <span class="dt">y =</span> <span class="fl">0.1</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb328-8" title="8">                           <span class="dt">size =</span> <span class="dv">12</span>)</a>
<a class="sourceLine" id="cb328-9" title="9">p</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-21"></span>
<img src="09_ggplot2_files/figure-html/unnamed-chunk-21-1.png" alt="Fitting a long label with `draw_label` from `cowplot`" width="276.0192" />
<p class="caption">
Figure 9.8: Fitting a long label with <code>draw_label</code> from <code>cowplot</code>
</p>
</div>
</div>
<div id="setting-the-aspect-ratio" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Setting the aspect ratio</h3>
<p>In the following plot the <code>x</code> and <code>y</code> variables are on the same scale, but we’ve purposefully added an outlier:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1">x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb329-2" title="2">y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb329-3" title="3">y[<span class="dv">1</span>] =<span class="st"> </span>y[<span class="dv">1</span>]<span class="op">+</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb329-4" title="4">dat =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)</a>
<a class="sourceLine" id="cb329-5" title="5">p =<span class="st"> </span><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb329-6" title="6">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb329-7" title="7">p</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="326.4" /></p>
<p>we can set the aspect ratio to 1 with <code>p = p + coord_fixed(ratio=1)</code></p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>(<span class="dt">ratio=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb330-2" title="2">p</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-23-1.png" width="326.4" /></p>
<p>this fixes the aspect ratio to 1, but the plot looks somewhat odd because it is not square. To fix this we need to calculate the ranges of both axes and set them at their max/min:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" title="1">p =<span class="st"> </span><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb331-2" title="2">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>, <span class="dt">intercept=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb331-3" title="3">xmax =<span class="st"> </span><span class="kw">max</span>(<span class="kw">layer_scales</span>(p)<span class="op">$</span>x<span class="op">$</span>range<span class="op">$</span>range)</a>
<a class="sourceLine" id="cb331-4" title="4">ymax =<span class="st"> </span><span class="kw">max</span>(<span class="kw">layer_scales</span>(p)<span class="op">$</span>y<span class="op">$</span>range<span class="op">$</span>range)</a>
<a class="sourceLine" id="cb331-5" title="5">xymax =<span class="st"> </span><span class="kw">max</span>(xmax,ymax)</a>
<a class="sourceLine" id="cb331-6" title="6">xmin =<span class="st"> </span><span class="kw">min</span>(<span class="kw">layer_scales</span>(p)<span class="op">$</span>x<span class="op">$</span>range<span class="op">$</span>range)</a>
<a class="sourceLine" id="cb331-7" title="7">ymin =<span class="st"> </span><span class="kw">min</span>(<span class="kw">layer_scales</span>(p)<span class="op">$</span>y<span class="op">$</span>range<span class="op">$</span>range)</a>
<a class="sourceLine" id="cb331-8" title="8">xymin =<span class="st"> </span><span class="kw">min</span>(xmin,ymin)</a>
<a class="sourceLine" id="cb331-9" title="9">p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>(<span class="dt">xlim=</span><span class="kw">c</span>(xymin,xymax), <span class="dt">ylim=</span><span class="kw">c</span>(xymin,xymax))</a>
<a class="sourceLine" id="cb331-10" title="10">p</a></code></pre></div>
<p><img src="09_ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="326.4" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wickham2009">
<p>Wickham, Hadley. 2009. <em>Ggplot2. Elegant Graphics for Data Analysis</em>. Springer.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fonts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotly.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sam81/rguide/edit/master/09_ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rguide.pdf", "rguide.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
