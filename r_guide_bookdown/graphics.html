<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Graphics | A R Guide</title>
  <meta name="description" content="A guide for the R programming language." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Graphics | A R Guide" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide for the R programming language." />
  <meta name="github-repo" content="sam81/rguide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Graphics | A R Guide" />
  
  <meta name="twitter:description" content="A guide for the R programming language." />
  

<meta name="author" content="Samuele Carcagno" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive.html"/>
<link rel="next" href="ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./preface.html">A R Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#installing-the-base-program"><i class="fa fa-check"></i><b>1.1</b> Installing the Base Program</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices"><i class="fa fa-check"></i><b>1.1.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#windows"><i class="fa fa-check"></i><b>1.1.2</b> Windows</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#mac-os-x"><i class="fa fa-check"></i><b>1.1.3</b> Mac Os X</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installing-add-on-packages"><i class="fa fa-check"></i><b>1.2</b> Installing Add-On Packages</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#gnulinux-and-other-unices-1"><i class="fa fa-check"></i><b>1.2.1</b> GNU/Linux and Other Unices</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#windows-1"><i class="fa fa-check"></i><b>1.2.2</b> Windows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> A Simple Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#datasets"><i class="fa fa-check"></i><b>2.1</b> Datasets</a></li>
<li class="chapter" data-level="2.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#firing-up-and-quitting-r"><i class="fa fa-check"></i><b>2.2</b> Firing up and Quitting R</a></li>
<li class="chapter" data-level="2.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#starting-to-work-with-r"><i class="fa fa-check"></i><b>2.3</b> Starting to Work with R</a></li>
<li class="chapter" data-level="2.4" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#gettinghelp"><i class="fa fa-check"></i><b>2.4</b> Getting Help</a><ul>
<li class="chapter" data-level="2.4.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-online-help-system"><i class="fa fa-check"></i><b>2.4.1</b> The Online Help System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#gui"><i class="fa fa-check"></i><b>2.5</b> Working with a Graphical User Interface</a><ul>
<li class="chapter" data-level="2.5.1" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#r-studio"><i class="fa fa-check"></i><b>2.5.1</b> R Studio</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#the-r-commander"><i class="fa fa-check"></i><b>2.5.2</b> The R Commander</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-simple-introduction-to-r.html"><a href="a-simple-introduction-to-r.html#jgr"><i class="fa fa-check"></i><b>2.5.3</b> JGR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html"><i class="fa fa-check"></i><b>3</b> Organising a Working Session</a><ul>
<li class="chapter" data-level="3.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#setting-and-changing-the-working-directory"><i class="fa fa-check"></i><b>3.1</b> Setting and Changing the Working Directory</a></li>
<li class="chapter" data-level="3.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#objects"><i class="fa fa-check"></i><b>3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#saving-and-using-the-workspace-image"><i class="fa fa-check"></i><b>3.3</b> Saving and Using the “Workspace Image”</a></li>
<li class="chapter" data-level="3.4" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#working-in-batch-mode"><i class="fa fa-check"></i><b>3.4</b> Working in Batch Mode</a><ul>
<li class="chapter" data-level="3.4.1" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-an-r-session"><i class="fa fa-check"></i><b>3.4.1</b> Executing commands written in a file from an R session</a></li>
<li class="chapter" data-level="3.4.2" data-path="organising-a-working-session.html"><a href="organising-a-working-session.html#executing-commands-written-in-a-file-from-a-shell"><i class="fa fa-check"></i><b>3.4.2</b> Executing commands written in a file from a shell</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manip.html"><a href="data-manip.html"><i class="fa fa-check"></i><b>4</b> Data Types and Data Manipulation</a><ul>
<li class="chapter" data-level="4.1" data-path="data-manip.html"><a href="data-manip.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a></li>
<li class="chapter" data-level="4.2" data-path="data-manip.html"><a href="data-manip.html#indexing-vectors"><i class="fa fa-check"></i><b>4.2</b> Indexing Vectors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-manip.html"><a href="data-manip.html#the-seq-function"><i class="fa fa-check"></i><b>4.2.1</b> The <code>seq</code> Function</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manip.html"><a href="data-manip.html#the-rep-function"><i class="fa fa-check"></i><b>4.2.2</b> The <code>rep</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-manip.html"><a href="data-manip.html#matrix-facilities"><i class="fa fa-check"></i><b>4.3</b> Matrix Facilities</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-manip.html"><a href="data-manip.html#matrix-operations"><i class="fa fa-check"></i><b>4.3.1</b> Matrix Operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-manip.html"><a href="data-manip.html#Lists"><i class="fa fa-check"></i><b>4.4</b> Lists</a></li>
<li class="chapter" data-level="4.5" data-path="data-manip.html"><a href="data-manip.html#dataframes"><i class="fa fa-check"></i><b>4.5</b> Dataframes</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-manip.html"><a href="data-manip.html#accessing-parts-of-a-dataframe"><i class="fa fa-check"></i><b>4.5.1</b> Accessing Parts of a Dataframe</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-manip.html"><a href="data-manip.html#change-the-names-of-variables-in-a-dataframe"><i class="fa fa-check"></i><b>4.5.2</b> Change the Names of Variables in a Dataframe</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-manip.html"><a href="data-manip.html#other-ways-to-subset-a-dataframe"><i class="fa fa-check"></i><b>4.5.3</b> Other Ways to Subset a Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-manip.html"><a href="data-manip.html#factors"><i class="fa fa-check"></i><b>4.6</b> Factors</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-manip.html"><a href="data-manip.html#renaming-the-levels-of-a-factor"><i class="fa fa-check"></i><b>4.6.1</b> Renaming the levels of a factor</a></li>
<li class="chapter" data-level="4.6.2" data-path="data-manip.html"><a href="data-manip.html#gl"><i class="fa fa-check"></i><b>4.6.2</b> Creating Factors with <code>gl</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-manip.html"><a href="data-manip.html#natural-sort-order-for-character-and-factor-vectors"><i class="fa fa-check"></i><b>4.6.3</b> Natural sort order for character and factor vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-manip.html"><a href="data-manip.html#getting-info-on-r-objects"><i class="fa fa-check"></i><b>4.7</b> Getting Info on R Objects</a></li>
<li class="chapter" data-level="4.8" data-path="data-manip.html"><a href="data-manip.html#changing-the-format-of-your-data"><i class="fa fa-check"></i><b>4.8</b> Changing the Format of Your Data</a><ul>
<li class="chapter" data-level="4.8.1" data-path="data-manip.html"><a href="data-manip.html#the-one-row-per-observation-format"><i class="fa fa-check"></i><b>4.8.1</b> The “One Row per Observation” Format</a></li>
<li class="chapter" data-level="4.8.2" data-path="data-manip.html"><a href="data-manip.html#stack"><i class="fa fa-check"></i><b>4.8.2</b> The <code>stack</code> and <code>unstack</code> functions</a></li>
<li class="chapter" data-level="4.8.3" data-path="data-manip.html"><a href="data-manip.html#tapply"><i class="fa fa-check"></i><b>4.8.3</b> The <code>tapply</code> and <code>aggregate</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="data-manip.html"><a href="data-manip.html#creating-and-editing-data-objects-through-a-visual-interface"><i class="fa fa-check"></i><b>4.9</b> Creating and Editing Data Objects through a Visual Interface</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualising-your-data.html"><a href="visualising-your-data.html"><i class="fa fa-check"></i><b>5</b> Visualising Your Data</a><ul>
<li class="chapter" data-level="5.1" data-path="visualising-your-data.html"><a href="visualising-your-data.html#reading-numbers-in-exponential-notation"><i class="fa fa-check"></i><b>5.1</b> Reading Numbers in Exponential Notation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="IO.html"><a href="IO.html"><i class="fa fa-check"></i><b>6</b> File Input/Output</a><ul>
<li class="chapter" data-level="6.1" data-path="IO.html"><a href="IO.html#reading-in-data-from-a-file"><i class="fa fa-check"></i><b>6.1</b> Reading In Data from a File</a><ul>
<li class="chapter" data-level="6.1.1" data-path="IO.html"><a href="IO.html#read.table"><i class="fa fa-check"></i><b>6.1.1</b> The <code>read.table</code> function</a></li>
<li class="chapter" data-level="6.1.2" data-path="IO.html"><a href="IO.html#scan"><i class="fa fa-check"></i><b>6.1.2</b> <code>scan</code></a></li>
<li class="chapter" data-level="6.1.3" data-path="IO.html"><a href="IO.html#low-level-file-input"><i class="fa fa-check"></i><b>6.1.3</b> Low-Level File Input</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="IO.html"><a href="IO.html#writing-data-to-a-file"><i class="fa fa-check"></i><b>6.2</b> Writing Data to a file</a><ul>
<li class="chapter" data-level="6.2.1" data-path="IO.html"><a href="IO.html#write.table"><i class="fa fa-check"></i><b>6.2.1</b> The <code>write.table</code> function</a></li>
<li class="chapter" data-level="6.2.2" data-path="IO.html"><a href="IO.html#cat"><i class="fa fa-check"></i><b>6.2.2</b> Low-Level File Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>7</b> Descriptive</a><ul>
<li class="chapter" data-level="7.1" data-path="descriptive.html"><a href="descriptive.html#tables"><i class="fa fa-check"></i><b>7.1</b> Tables</a></li>
<li class="chapter" data-level="7.2" data-path="descriptive.html"><a href="descriptive.html#the-scale-function"><i class="fa fa-check"></i><b>7.2</b> The <code>scale</code> Function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>8</b> Graphics</a><ul>
<li class="chapter" data-level="8.1" data-path="graphics.html"><a href="graphics.html#overview-of-r-base-graphics-functions"><i class="fa fa-check"></i><b>8.1</b> Overview of R base graphics functions</a></li>
<li class="chapter" data-level="8.2" data-path="graphics.html"><a href="graphics.html#plot"><i class="fa fa-check"></i><b>8.2</b> The <code>plot</code> Function</a></li>
<li class="chapter" data-level="8.3" data-path="graphics.html"><a href="graphics.html#drawing-functions"><i class="fa fa-check"></i><b>8.3</b> Drawing Functions</a><ul>
<li class="chapter" data-level="8.3.1" data-path="graphics.html"><a href="graphics.html#the-matplot-function"><i class="fa fa-check"></i><b>8.3.1</b> The <code>matplot</code> function</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="graphics.html"><a href="graphics.html#barplots"><i class="fa fa-check"></i><b>8.4</b> Barplots</a><ul>
<li class="chapter" data-level="8.4.1" data-path="graphics.html"><a href="graphics.html#barplots-with-error-bars"><i class="fa fa-check"></i><b>8.4.1</b> Barplots with Error Bars</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="graphics.html"><a href="graphics.html#boxplots"><i class="fa fa-check"></i><b>8.5</b> Boxplots</a></li>
<li class="chapter" data-level="8.6" data-path="graphics.html"><a href="graphics.html#histograms"><i class="fa fa-check"></i><b>8.6</b> Histograms</a></li>
<li class="chapter" data-level="8.7" data-path="graphics.html"><a href="graphics.html#stripcharts"><i class="fa fa-check"></i><b>8.7</b> Stripcharts</a></li>
<li class="chapter" data-level="8.8" data-path="graphics.html"><a href="graphics.html#interaction-plots"><i class="fa fa-check"></i><b>8.8</b> Interaction Plots</a></li>
<li class="chapter" data-level="8.9" data-path="graphics.html"><a href="graphics.html#par"><i class="fa fa-check"></i><b>8.9</b> Setting Graphics Parameters</a><ul>
<li class="chapter" data-level="8.9.1" data-path="graphics.html"><a href="graphics.html#lty"><i class="fa fa-check"></i><b>8.9.1</b> Line type with the <code>lty</code> parameter</a></li>
<li class="chapter" data-level="8.9.2" data-path="graphics.html"><a href="graphics.html#secpch"><i class="fa fa-check"></i><b>8.9.2</b> Symbols with the <code>pch</code> parameter</a></li>
<li class="chapter" data-level="8.9.3" data-path="graphics.html"><a href="graphics.html#fonts"><i class="fa fa-check"></i><b>8.9.3</b> Fonts</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="graphics.html"><a href="graphics.html#adding-elements-to-a-plot"><i class="fa fa-check"></i><b>8.10</b> Adding Elements to a Plot</a><ul>
<li class="chapter" data-level="8.10.1" data-path="graphics.html"><a href="graphics.html#legend"><i class="fa fa-check"></i><b>8.10.1</b> Adding a Legend</a></li>
<li class="chapter" data-level="8.10.2" data-path="graphics.html"><a href="graphics.html#adding-text"><i class="fa fa-check"></i><b>8.10.2</b> Adding Text</a></li>
<li class="chapter" data-level="8.10.3" data-path="graphics.html"><a href="graphics.html#addgrid"><i class="fa fa-check"></i><b>8.10.3</b> Adding a Grid</a></li>
<li class="chapter" data-level="8.10.4" data-path="graphics.html"><a href="graphics.html#axes"><i class="fa fa-check"></i><b>8.10.4</b> Setting the Axes</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="graphics.html"><a href="graphics.html#creating-layouts-for-multiple-graphs-glayout"><i class="fa fa-check"></i><b>8.11</b> Creating Layouts for Multiple Graphs {glayout}</a><ul>
<li class="chapter" data-level="8.11.1" data-path="graphics.html"><a href="graphics.html#mfrow-and-mfcol-mfrowmfcol"><i class="fa fa-check"></i><b>8.11.1</b> mfrow and mfcol {mfrowmfcol}</a></li>
<li class="chapter" data-level="8.11.2" data-path="graphics.html"><a href="graphics.html#layout"><i class="fa fa-check"></i><b>8.11.2</b> layout</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="graphics.html"><a href="graphics.html#graphics-device-regions-and-coordinates"><i class="fa fa-check"></i><b>8.12</b> Graphics Device Regions and Coordinates</a></li>
<li class="chapter" data-level="8.13" data-path="graphics.html"><a href="graphics.html#plotfromscratch"><i class="fa fa-check"></i><b>8.13</b> Plotting from Scratch</a></li>
<li class="chapter" data-level="8.14" data-path="graphics.html"><a href="graphics.html#colours-for-graphics"><i class="fa fa-check"></i><b>8.14</b> Colours for Graphics</a><ul>
<li class="chapter" data-level="8.14.1" data-path="graphics.html"><a href="graphics.html#colour-opacity"><i class="fa fa-check"></i><b>8.14.1</b> Colour Opacity</a></li>
</ul></li>
<li class="chapter" data-level="8.15" data-path="graphics.html"><a href="graphics.html#managing-graphic-devices"><i class="fa fa-check"></i><b>8.15</b> Managing Graphic Devices</a><ul>
<li class="chapter" data-level="8.15.1" data-path="graphics.html"><a href="graphics.html#opening-another-graphics-window"><i class="fa fa-check"></i><b>8.15.1</b> Opening Another Graphics Window</a></li>
<li class="chapter" data-level="8.15.2" data-path="graphics.html"><a href="graphics.html#exporting-graphics"><i class="fa fa-check"></i><b>8.15.2</b> Exporting Graphics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>9</b> ggplot2</a><ul>
<li class="chapter" data-level="9.0.1" data-path="ggplot2.html"><a href="ggplot2.html#log-axis-with-pretty-tickmarks"><i class="fa fa-check"></i><b>9.0.1</b> Log axis with pretty tickmarks</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>10</b> Plotly</a><ul>
<li class="chapter" data-level="10.1" data-path="plotly.html"><a href="plotly.html#using-plotly-with-knitr"><i class="fa fa-check"></i><b>10.1</b> Using plotly with knitr</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lattice.html"><a href="lattice.html"><i class="fa fa-check"></i><b>11</b> Lattice Graphics</a><ul>
<li class="chapter" data-level="11.1" data-path="lattice.html"><a href="lattice.html#overview-of-lattice-graphics"><i class="fa fa-check"></i><b>11.1</b> Overview of Lattice Graphics</a></li>
<li class="chapter" data-level="11.2" data-path="lattice.html"><a href="lattice.html#introduction-to-model-formulae-and-multi-panel-conditioning"><i class="fa fa-check"></i><b>11.2</b> Introduction to model formulae and multi-panel conditioning</a></li>
<li class="chapter" data-level="11.3" data-path="lattice.html"><a href="lattice.html#barchart"><i class="fa fa-check"></i><b>11.3</b> <code>barchart</code></a></li>
<li class="chapter" data-level="11.4" data-path="lattice.html"><a href="lattice.html#dotplot"><i class="fa fa-check"></i><b>11.4</b> dotplot</a></li>
<li class="chapter" data-level="11.5" data-path="lattice.html"><a href="lattice.html#histogram"><i class="fa fa-check"></i><b>11.5</b> histogram</a></li>
<li class="chapter" data-level="11.6" data-path="lattice.html"><a href="lattice.html#interaction-plots-1"><i class="fa fa-check"></i><b>11.6</b> Interaction Plots</a></li>
<li class="chapter" data-level="11.7" data-path="lattice.html"><a href="lattice.html#customizingtrellis"><i class="fa fa-check"></i><b>11.7</b> Customising Lattice Graphics</a><ul>
<li class="chapter" data-level="11.7.1" data-path="lattice.html"><a href="lattice.html#textual-elements"><i class="fa fa-check"></i><b>11.7.1</b> Textual Elements</a></li>
<li class="chapter" data-level="11.7.2" data-path="lattice.html"><a href="lattice.html#log-axis-with-pretty-tickmarks-1"><i class="fa fa-check"></i><b>11.7.2</b> Log axis with pretty tickmarks</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="lattice.html"><a href="lattice.html#trellispanel"><i class="fa fa-check"></i><b>11.8</b> Writing Panel Functions</a><ul>
<li class="chapter" data-level="11.8.1" data-path="lattice.html"><a href="lattice.html#combining-panel-functions"><i class="fa fa-check"></i><b>11.8.1</b> Combining Panel Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="graphics-labels-and-text.html"><a href="graphics-labels-and-text.html"><i class="fa fa-check"></i><b>12</b> Graphics labels and text</a><ul>
<li class="chapter" data-level="12.1" data-path="graphics-labels-and-text.html"><a href="graphics-labels-and-text.html#mathematical-expressions-and-variables"><i class="fa fa-check"></i><b>12.1</b> Mathematical expressions and variables</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html"><i class="fa fa-check"></i><b>13</b> Probability Distribution Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#bernoulli"><i class="fa fa-check"></i><b>13.1</b> The Bernoulli distribution</a></li>
<li class="chapter" data-level="13.2" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#binomial"><i class="fa fa-check"></i><b>13.2</b> The binomial distribution</a></li>
<li class="chapter" data-level="13.3" data-path="probability-distribution-functions.html"><a href="probability-distribution-functions.html#normal"><i class="fa fa-check"></i><b>13.3</b> The normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>14</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="14.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#chi2-test"><i class="fa fa-check"></i><b>14.1</b> <span class="math inline">\(\chi^2\)</span> test</a><ul>
<li class="chapter" data-level="14.1.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-hypotheses-about-the-distribution-of-a-categorical-variable"><i class="fa fa-check"></i><b>14.1.1</b> Testing Hypotheses about the Distribution of a Categorical Variable</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#students-t-test"><i class="fa fa-check"></i><b>14.2</b> Student’s <em>t</em> test</a><ul>
<li class="chapter" data-level="14.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>14.2.1</b> One sample <em>t</em>-test</a></li>
<li class="chapter" data-level="14.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#two-samples-t-test"><i class="fa fa-check"></i><b>14.2.2</b> Two samples t-test</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#the-levene-test-for-homogeneity-of-variances"><i class="fa fa-check"></i><b>14.3</b> The Levene Test for Homogeneity of Variances</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html"><i class="fa fa-check"></i><b>15</b> Correlation and Regression</a><ul>
<li class="chapter" data-level="15.1" data-path="correlation-and-regression.html"><a href="correlation-and-regression.html#linear-regression"><i class="fa fa-check"></i><b>15.1</b> Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>16</b> ANOVA</a><ul>
<li class="chapter" data-level="16.1" data-path="anova.html"><a href="anova.html#one-way-anova"><i class="fa fa-check"></i><b>16.1</b> One-Way ANOVA</a></li>
<li class="chapter" data-level="16.2" data-path="anova.html"><a href="anova.html#repeated-measures-anova"><i class="fa fa-check"></i><b>16.2</b> Repeated Measures ANOVA</a><ul>
<li class="chapter" data-level="16.2.1" data-path="anova.html"><a href="anova.html#one-within-subjects-factor"><i class="fa fa-check"></i><b>16.2.1</b> One Within Subjects Factor</a></li>
<li class="chapter" data-level="16.2.2" data-path="anova.html"><a href="anova.html#two-within-subjects-factors"><i class="fa fa-check"></i><b>16.2.2</b> Two Within Subjects Factors</a></li>
<li class="chapter" data-level="16.2.3" data-path="anova.html"><a href="anova.html#two-within-subjects-factors-and-one-between"><i class="fa fa-check"></i><b>16.2.3</b> Two Within Subjects Factors and One Between</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="how-to-adjust-the-p-values-for-multiple-comparisons.html"><a href="how-to-adjust-the-p-values-for-multiple-comparisons.html"><i class="fa fa-check"></i><b>17</b> How to Adjust the p-values for Multiple Comparisons</a></li>
<li class="chapter" data-level="18" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>18</b> R Programming</a><ul>
<li class="chapter" data-level="18.1" data-path="programming.html"><a href="programming.html#contrstruct"><i class="fa fa-check"></i><b>18.1</b> Control Structures</a></li>
<li class="chapter" data-level="18.2" data-path="programming.html"><a href="programming.html#stringprocessing"><i class="fa fa-check"></i><b>18.2</b> String Processing</a><ul>
<li class="chapter" data-level="18.2.1" data-path="programming.html"><a href="programming.html#regexp"><i class="fa fa-check"></i><b>18.2.1</b> Using Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="programming.html"><a href="programming.html#tips-and-tricks"><i class="fa fa-check"></i><b>18.3</b> Tips and Tricks</a><ul>
<li class="chapter" data-level="18.3.1" data-path="programming.html"><a href="programming.html#convert-a-string-into-a-command"><i class="fa fa-check"></i><b>18.3.1</b> Convert a String into a Command</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="programming.html"><a href="programming.html#creatingsimplerpackages"><i class="fa fa-check"></i><b>18.4</b> Creating Simple R Packages</a><ul>
<li class="chapter" data-level="18.4.1" data-path="programming.html"><a href="programming.html#the-bare-minimum-to-create-a-package"><i class="fa fa-check"></i><b>18.4.1</b> The Bare Minimum to Create a Package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="custom.html"><a href="custom.html"><i class="fa fa-check"></i><b>19</b> Environment Customisation</a></li>
<li class="chapter" data-level="20" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html"><i class="fa fa-check"></i><b>20</b> ESS: Using Emacs Speaks Statistics with R</a><ul>
<li class="chapter" data-level="20.1" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-for-editing-and-debugging-r-source-files"><i class="fa fa-check"></i><b>20.1</b> Using ESS for Editing and Debugging R Source Files</a></li>
<li class="chapter" data-level="20.2" data-path="ess-using-emacs-speaks-statistics-with-r.html"><a href="ess-using-emacs-speaks-statistics-with-r.html#using-ess-to-interact-with-a-r-process"><i class="fa fa-check"></i><b>20.2</b> Using ESS to Interact with a R Process</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html"><i class="fa fa-check"></i><b>21</b> Using Sweave to Write Documents with R and LaTeX</a><ul>
<li class="chapter" data-level="21.1" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#whats-sweave"><i class="fa fa-check"></i><b>21.1</b> What’s Sweave?</a></li>
<li class="chapter" data-level="21.2" data-path="using-sweave-to-write-documents-with-r-and-latex.html"><a href="using-sweave-to-write-documents-with-r-and-latex.html#usage"><i class="fa fa-check"></i><b>21.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="soundprocessing.html"><a href="soundprocessing.html"><i class="fa fa-check"></i><b>22</b> Sound Processing</a><ul>
<li class="chapter" data-level="22.1" data-path="soundprocessing.html"><a href="soundprocessing.html#libraries-for-sound-analysis-and-signal-processing"><i class="fa fa-check"></i><b>22.1</b> Libraries for Sound Analysis and Signal Processing</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html"><i class="fa fa-check"></i><b>A</b> Partial List of Packages by Category</a><ul>
<li class="chapter" data-level="A.1" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#graphics-packages"><i class="fa fa-check"></i><b>A.1</b> Graphics Packages</a></li>
<li class="chapter" data-level="A.2" data-path="partial-list-of-packages-by-category.html"><a href="partial-list-of-packages-by-category.html#gui-packages"><i class="fa fa-check"></i><b>A.2</b> GUI Packages</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="miscellaneous-commands.html"><a href="miscellaneous-commands.html"><i class="fa fa-check"></i><b>B</b> Miscellaneous commands</a></li>
<li class="chapter" data-level="C" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html"><i class="fa fa-check"></i><b>C</b> Other Manuals and Sources of Information on R</a><ul>
<li class="chapter" data-level="C.0.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian"><i class="fa fa-check"></i><b>C.0.1</b> In Italian</a></li>
<li class="chapter" data-level="C.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#other-useful-statistics-resources"><i class="fa fa-check"></i><b>C.1</b> Other useful statistics resources</a><ul>
<li class="chapter" data-level="C.1.1" data-path="other-manuals-and-sources-of-information-on-r.html"><a href="other-manuals-and-sources-of-information-on-r.html#in-italian-1"><i class="fa fa-check"></i><b>C.1.1</b> In Italian</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="fullcoltable.html"><a href="fullcoltable.html"><i class="fa fa-check"></i><b>D</b> Full Colours Table</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A R Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1">
<h1><span class="header-section-number">8</span> Graphics</h1>
<p>There are four main graphics libraries that can be used in R. The first is the base graphics system that comes builtin with every R installation and will be described in this chapter. The other three main graphics libraries (<code>ggplot2</code>, <code>lattice</code>, and <code>plotly</code>), can be installed as additional packages. Each of these libraries provide a complete, independent system to generate graphics in R. Choosing one library over the other is mostly a matter of personal preference because pretty much any graphic that can be built with one library can also be built with the others. Some graphics are easier to build with one library than another and vice-versa. In recent years <code>ggplot2</code> has gained lots of popularity and <code>lattice</code> is less popular than it was some years ago. Despite the increasing popularity of <code>ggplot2</code> the base R graphics that are described in this chapter are still widely used. <code>plotly</code> is a recent entry and is somehow a special case because it is primarily designed to generate interactive graphics that can be displayed on html pages, while the other graphics libraries have very limited interactive functionality and are primarily designed to generate static high-quality graphics. <code>plotly</code> is special also because through the <code>ggplotly</code> function it can convert a <code>ggplot2</code> graph into an interactive <code>plotly</code> graphic.</p>
<p>Because the base R graphics library is still widely used and (in my opinion) is somewhat simpler to use for beginners, I would recommend learning it first. The <code>ggplot2</code> library is described in chapter <a href="ggplot2.html#ggplot2">9</a>, the <code>lattice</code> graphics library is described in chapter <a href="lattice.html#lattice">11</a>, and the <code>plotly</code> library is described in chapter <a href="plotly.html#plotly">10</a>.</p>
<div id="overview-of-r-base-graphics-functions" class="section level2">
<h2><span class="header-section-number">8.1</span> Overview of R base graphics functions</h2>
<table>
<thead>
<tr class="header">
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>plot</code></td>
</tr>
<tr class="even">
<td><code>barplot</code></td>
</tr>
<tr class="odd">
<td><code>boxplot</code></td>
</tr>
<tr class="even">
<td><code>histogram</code></td>
</tr>
<tr class="odd">
<td><code>matplot</code></td>
</tr>
<tr class="even">
<td><code>stripchart</code></td>
</tr>
<tr class="odd">
<td><code>interaction.plot</code></td>
</tr>
</tbody>
</table>
</div>
<div id="plot" class="section level2">
<h2><span class="header-section-number">8.2</span> The <code>plot</code> Function</h2>
<p>The <code>plot</code> function is most commonly used to draw a scatterplot of two variables, however if given a R object with a plot method as an argument it will produce different types of graphics depending on the object it is plotting. Let’s see an example of a scatterplot with some simulated data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  a =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">5</span>, <span class="fl">1.6</span>, <span class="dt">n=</span><span class="dv">50</span>)
  b =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>, <span class="fl">4.3</span>, <span class="dt">n=</span><span class="dv">50</span>)</code></pre></div>
<p>this creates two vectors of length 50 with values normally distributed, now we can plot the values of vector <code>b</code>, against the values of vector <code>b</code> with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span>a, <span class="dt">y=</span>b) ## or for short plot(a, b)</code></pre></div>
<div class="figure"><span id="fig:scatterplot"></span>
<img src="graphics_files/figure-html/scatterplot-1.png" alt="A scatterplot." width="576" />
<p class="caption">
Figure 8.1: A scatterplot.
</p>
</div>
<p>the resulting scatterplot appears in Figure <a href="graphics.html#fig:scatterplot">8.1</a>.</p>
<p>If we were to plot the change of a variable over time it could be a good idea to connect the values at different time points in the plot with lines, this is easily achieved setting the option <code>type</code>. Below is an example, the result is shown in Figure <a href="graphics.html#fig:timewlines">8.2</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ti=<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>
b=<span class="kw">rnorm</span>(<span class="dv">15</span>,<span class="fl">4.3</span>,<span class="dt">n=</span><span class="dv">50</span>)
<span class="kw">plot</span>(ti, b, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:timewlines"></span>
<img src="graphics_files/figure-html/timewlines-1.png" alt="Values connected by lines." width="576" />
<p class="caption">
Figure 8.2: Values connected by lines.
</p>
</div>
<p>Some other possible values for the option <code>type</code> are <code>p</code> for points (the default), <code>b</code> for <em>both</em> points and lines, and <code>o</code> for overplotted points and lines (very similar to <code>b</code>).</p>
</div>
<div id="drawing-functions" class="section level2">
<h2><span class="header-section-number">8.3</span> Drawing Functions</h2>
<p>The <code>plot</code> function can be used for drawing mathematical functions, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">4</span><span class="op">*</span>pi, <span class="dt">length=</span><span class="dv">120</span>)
<span class="kw">plot</span>(vec,<span class="kw">sin</span>(vec), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-2-1.png" width="576" /></p>
<p>in this case is necessary to use <code>l</code> as the type of plot, otherwise the plot would resemble a messy scatterplot. It is also possible to plot markers on the points in which the function is actually evaluated. Using the option <code>b</code> for the plot type, both a continuous line and markers are plotted. There are lots of options to define the appearance of a plot, next comes an overloaded example used just to introduce some of these options. A more detailed description is given in Section <a href="graphics.html#par">8.9</a>.</p>
<div id="the-matplot-function" class="section level3">
<h3><span class="header-section-number">8.3.1</span> The <code>matplot</code> function</h3>
<p>Plotting the sine and cosine functions together with the <code>matplot</code> function, the result is in Figure <a href="graphics.html#fig:sincos">8.3</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span> <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">length=</span><span class="dv">20</span>)
s =<span class="st"> </span><span class="kw">sin</span>(a)
c =<span class="st"> </span><span class="kw">cos</span>(a)
aa =<span class="st"> </span><span class="kw">cbind</span>(a,a) <span class="co">#matrix of hor coord</span>
cs =<span class="st"> </span><span class="kw">cbind</span>(c,s) <span class="co">#matrix of vert coord</span>
<span class="kw">matplot</span>(<span class="dt">x=</span>aa, <span class="dt">y=</span>cs, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="fl">1.8</span>, <span class="dt">ylab=</span><span class="st">&quot;sine and cosine functions&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:sincos"></span>
<img src="graphics_files/figure-html/sincos-1.png" alt="Sine and cosine functions with `matplot`." width="576" />
<p class="caption">
Figure 8.3: Sine and cosine functions with <code>matplot</code>.
</p>
</div>
</div>
</div>
<div id="barplots" class="section level2">
<h2><span class="header-section-number">8.4</span> Barplots</h2>
<p>Barplots sometimes come in handy when you want to summarise your data. Suppose we have administered a test to three different groups of people, which we will designate as <code>a</code>, <code>b</code> and <code>c</code>. We want to summarise and compare the performance of each group with a nice graph, a barplot will make it. The data are stored in the file <code>test.txt</code>, in the format shown in Table <a href="graphics.html#tab:test">8.1</a>.</p>
<table>
<caption><span id="tab:test">Table 8.1: </span> Data for the test example.</caption>
<thead>
<tr class="header">
<th><strong>a</strong></th>
<th><strong>b</strong></th>
<th><strong>c</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>4</td>
<td>6</td>
<td>5</td>
</tr>
<tr class="even">
<td>5</td>
<td>8</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="even">
<td>6</td>
<td>5</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="even">
<td>7</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>5</td>
</tr>
<tr class="even">
<td>8</td>
<td>5</td>
<td>7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>6</td>
</tr>
<tr class="even">
<td>4</td>
<td>10</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>We can read in the file directly as a dataframe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;datasets/test.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>We want to use the <code>tapply</code> function to get quickly summary tables with the means and standard deviations for the three groups. However the format of the data frame at this point is not suitable for the <code>tapply</code> function, because it has 3 observations for each row, and the <code>tapply</code> function can be used only with the format “one row per observation”, in which we have the values of the observations in one column and a set of “labels” identifying the group to which a given observation belongs to in another column. Fortunately, we can easily change the format of our dataframe with the <code>stack</code> command. What it does is just to create a single “values” vector from the three columns we had previously, and to add automatically another “index” vector with the labels we need:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test2 =<span class="st"> </span><span class="kw">stack</span>(test)</code></pre></div>
<p>we can have a look at the first elements of the new dataframe typing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(test2, <span class="dt">n=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>##    values ind
## 1       4   a
## 2       5   a
## 3       3   a
## 4       6   a
## 5       5   a
## 6       7   a
## 7       5   a
## 8       8   a
## 9       5   a
## 10      4   a</code></pre>
<p>please notice that the <code>stack</code> function has automatically named the two vectors <code>values</code> and <code>ind</code>, we need to know these names to use the <code>tapply</code> function.</p>
<p>Now we’ll create the two summary tables using the <code>tapply</code> function, one with the means and one with the standard deviations for the three groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_means =<span class="st"> </span><span class="kw">tapply</span>(<span class="dt">X=</span>test2<span class="op">$</span>values, <span class="dt">IND=</span>test2<span class="op">$</span>ind, <span class="dt">FUN=</span>mean)
test_sd =<span class="st"> </span><span class="kw">tapply</span>(<span class="dt">X=</span>test2<span class="op">$</span>values, <span class="dt">IND=</span>test2<span class="op">$</span>ind, <span class="dt">FUN=</span>sd)</code></pre></div>
<p>Now we can draw a simple barplot displaying the means for each group:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(test_means, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;salmon2&quot;</span>,<span class="st">&quot;plum4&quot;</span>))</code></pre></div>
<div class="figure"><span id="fig:barplotsimple"></span>
<img src="graphics_files/figure-html/barplotsimple-1.png" alt="Simple barplot." width="576" />
<p class="caption">
Figure 8.4: Simple barplot.
</p>
</div>
<p>we’ve added colours to the graph using the <code>col</code> option. You can look at the resulting graph in Figure <a href="graphics.html#fig:barplotsimple">8.4</a>.</p>
<p>You can control the width of the bars specifying the <code>width</code> option, and setting the range for the x axis with the <code>xlim</code> option, specifying only the width does nothing, you must also set the <code>xlim</code>. You set <code>xlim</code> with a vector of the form <code>xlim = c(from, to)</code>, in which <code>from</code> is the origin and <code>to</code> is the end of the axis. In the example below we will set <code>xlim</code> to go from 0 to 3 and the bars to have a width of 0.5:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(test_means,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;salmon2&quot;</span>,<span class="st">&quot;plum4&quot;</span>),
        <span class="dt">xlim =</span> <span class="kw">C</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="dt">width=</span><span class="fl">0.5</span>)</code></pre></div>
<p>this sets the width of all bars at 0.5, we could specify the width for each single bar instead, by giving to <code>width</code> a vector with the width values for each bar.</p>
<p>You can also control the spacing between the bars with the <code>space</code> option. The default is set to 0.2.</p>
<div id="barplots-with-error-bars" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Barplots with Error Bars</h3>
<p>Now let’s say we want to get the same barplot but with error bars showing the standard deviation for each group. We could achieve this result adding lines to the current graph, but there is a better option, we can use the <code>barplot2</code> command, which comes with the <code>gplots</code> library and provides an easy way of adding error bars to a barplot. So once we have the `gplots} package installed we first load it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gplots)</code></pre></div>
<p>and then we can draw our barplot with error bars. To get them, we need to set the option <code>plot.ci=TRUE</code> and then specify the upper and lower bounds of the error bars with the <code>ci.u</code> and <code>ci.l</code> commands. So we first create the values for <code>ci.u</code> and <code>ci.l</code>, so that the error bars represent one standard deviation around the mean. We’ll use the values from the two tables we had created before, with means and standard deviations for the three groups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">upper =<span class="st"> </span>test_means <span class="op">+</span><span class="st"> </span>(test_sd)
lower =<span class="st"> </span>test_means <span class="op">-</span><span class="st"> </span>(test_sd)</code></pre></div>
<p>Now we can draw our barplot, you can see the result in Figure <a href="graphics.html#fig:barplotbars">8.5</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot2</span>(test_means,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;salmon2&quot;</span>,<span class="st">&quot;plum4&quot;</span>),
         <span class="dt">plot.ci=</span><span class="ot">TRUE</span>,<span class="dt">ci.u=</span>upper,<span class="dt">ci.l=</span>lower)</code></pre></div>
<div class="figure"><span id="fig:barplotbars"></span>
<img src="graphics_files/figure-html/barplotbars-1.png" alt="Barplot with error bars." width="576" />
<p class="caption">
Figure 8.5: Barplot with error bars.
</p>
</div>
</div>
</div>
<div id="boxplots" class="section level2">
<h2><span class="header-section-number">8.5</span> Boxplots</h2>
<p>Boxplots can be used to visualise the central tendency and the dispersion of the data for a given sample, and to directly compare these same characteristics for different samples. Let’s look at one of them, the data are organised in a dataframe in the file <code>boxplot1.txt</code>. They are the scores for two different groups (group a and group b) in a test. With the boxplot we want to see how the scores are distributed in the two groups. The dataframe contains a column <code>score</code>, with the score for each subject and another column <code>group</code> that defines the group a given observation comes from. So we first read in the dataframe, and then ask for the boxplots with the distribution of scores, as a function of the group they belong to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dats =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;datasets/boxplot1.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="kw">boxplot</span>(dats<span class="op">$</span>score<span class="op">~</span>dats<span class="op">$</span>group, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;group a&quot;</span>, <span class="st">&quot;group b&quot;</span>))</code></pre></div>
<div class="figure"><span id="fig:boxplot1"></span>
<img src="graphics_files/figure-html/boxplot1-1.png" alt="Boxplots comparing the distribution for two groups." width="576" />
<p class="caption">
Figure 8.6: Boxplots comparing the distribution for two groups.
</p>
</div>
<p>The results are in Figure <a href="graphics.html#fig:boxplot1">8.6</a>, the thick black lines in the middle of the boxes represent the median, if this is about the middle of the box, the distribution of the data should be normal. The two lines that delimit the box are called “hinges”, and they are approximately the first and the third quartiles. The horizontal lines that form the `Ts’ above and below the box are called ``whiskers’’, and inside them are contained all the observations that fall within a distance of 1.5 times the size of the box, upwards or downwards. Points that fall outside this distance are outliers and they are represented as a circle. In our case there are two outliers in group a. Apart from checking if the distribution is normal, you can also check if the variances are approximately equal, by comparing the size of the boxes (the distance between the hinges). If one boxplot is clearly bigger than the other one (for example two times bigger), then the variances for the two groups are likely not to be equal.</p>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">8.6</span> Histograms</h2>
<p>Histograms can be used to visualise the distribution of a sample, the function <code>hist</code>, can be used to plots a histogram of frequencies (counts) of the sample, or of its density function (setting the option <code>freq=F</code>). Let’s first create a sample with a normal distribution, and then plot its histogram, the result is in Figure <a href="graphics.html#fig:hist">8.7</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_distr =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="fl">1.7</span>)
<span class="kw">hist</span>(my_distr)</code></pre></div>
<div class="figure"><span id="fig:hist"></span>
<img src="graphics_files/figure-html/hist-1.png" alt="Frequency distribution of a random sample." width="576" />
<p class="caption">
Figure 8.7: Frequency distribution of a random sample.
</p>
</div>
</div>
<div id="stripcharts" class="section level2">
<h2><span class="header-section-number">8.7</span> Stripcharts</h2>
<p>If the groups contain a small number of observations, it might be better to use a stripchart to visualise their distributions. In a stripchart each point represents a single observation. By default they are drawn on a line, so if two observations have the same score, they overlap. To avoid this problem you can give a certain amount of jitter to the plot, so that observations with the same score are scattered a little and can be easily distinguished. Here’s the code for producing a stripchart, the data are in the file <code>stripchart1.txt</code> and they are arranged in the same way as the data in <code>boxplot1.txt</code>, just the sample sizes are smaller, with 6 observations per group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stripchart</span>(dats<span class="op">$</span>score<span class="op">~</span>dats<span class="op">$</span>group, <span class="dt">method=</span><span class="st">&quot;jitter&quot;</span>,
           <span class="dt">jitter=</span><span class="fl">0.1</span>, <span class="dt">pch=</span><span class="dv">1</span>, <span class="dt">vertical=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="figure"><span id="fig:stripchart1"></span>
<img src="graphics_files/figure-html/stripchart1-1.png" alt="Stripchart example." width="576" />
<p class="caption">
Figure 8.8: Stripchart example.
</p>
</div>
</div>
<div id="interaction-plots" class="section level2">
<h2><span class="header-section-number">8.8</span> Interaction Plots</h2>
<p>Interaction plots can be used to visualise the means for the levels of a factor, at the levels of another factor, for example in a two-way ANOVA design, and in this way they allow to spot possible interactions between the two factors involved. The following graph comes from a two-way ANOVA design, in which the variable of interest was the proportion of errors in a task, as a function of the spatial congruency and stimulus onset asincrony (SOA), of a distracting stimulus presented during the execution of the task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dats =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;datasets/direrr_all.txt&#39;</span>, <span class="dt">header=</span>T)
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">1</span>] =<span class="st"> &#39;c - congruent&#39;</span>
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">2</span>] =<span class="st"> &#39;a - inc. goal-directed&#39;</span>
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">3</span>] =<span class="st"> &#39;b - inc. no-goal-directed&#39;</span>

<span class="kw">interaction.plot</span>(dats<span class="op">$</span>SOA,dats<span class="op">$</span>congr,dats<span class="op">$</span>errors,
                 <span class="dt">ylab=</span><span class="st">&quot;Proportion of errors&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;SOA&quot;</span>,
                 <span class="dt">trace.label=</span><span class="st">&quot;Congruency&quot;</span>,
                 <span class="dt">lty=</span><span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotdash&quot;</span>))</code></pre></div>
<div class="figure"><span id="fig:int"></span>
<img src="graphics_files/figure-html/int-1.png" alt="Interaction plot with different line types." width="576" />
<p class="caption">
Figure 8.9: Interaction plot with different line types.
</p>
</div>
<p>well the essential ingredients to get the plot are just the first three arguments (the others are optional), the default order in which you have to give them is a bit awkward, because the variable of interest (in our case <code>dats$errors</code>) is the third argument, the first one is the factor that goes on the x axis, and the second one is the <em>trace factor</em>, whose levels will be represented as lines of a different type, or of different colours. The y axis yields the measure for our variable of interest. You can see the plot in Figure <a href="graphics.html#fig:int">8.9</a>. Another good way to represent the levels for the trace factor, is through the use of symbols, in the following graph (see the result in Figure <a href="graphics.html#fig:intb">8.10</a>) both line type <code>lty</code> and symbols <code>pch</code> are used to differentiate between the levels of the trace factor, in order to get this you need to set the option <code>type</code> to <code>b</code> that means use both line type and points (symbols), setting this option to <code>l</code> will give just different line types while setting it to <code>p</code>, will give just different symbols. In these examples I specified the line types and the symbols to use, but this is not necessary, if you don’t, R will cycle through its different line types and/or symbols as necessary to represent all the levels of the trace factor. See Section <a href="graphics.html#lty">8.9.1</a> for a description of the different line types and Section <a href="graphics.html#secpch">8.9.2</a> for a description of the different symbols available in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">interaction.plot</span>(dats<span class="op">$</span>SOA,dats<span class="op">$</span>congr,dats<span class="op">$</span>errors,
                 <span class="dt">ylab=</span><span class="st">&quot;Proportion of errors&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;SOA&quot;</span>,
                 <span class="dt">trace.label=</span><span class="st">&quot;Congruency&quot;</span>,
                 <span class="dt">lty=</span><span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotdash&quot;</span>),
                 <span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">17</span>))</code></pre></div>
<div class="figure"><span id="fig:intb"></span>
<img src="graphics_files/figure-html/intb-1.png" alt="Interaction plot with different line types and different symbols." width="576" />
<p class="caption">
Figure 8.10: Interaction plot with different line types and different symbols.
</p>
</div>

</div>
<div id="par" class="section level2">
<h2><span class="header-section-number">8.9</span> Setting Graphics Parameters</h2>
<p>Graphics parameters allow you to tweak many elements of a plot, such as the font for the labels, the symbols or line types to use and so on, see <code>?par</code> to get a full list and description of these parameters. Graphics parameters can be set and accessed with the function <code>par</code>, called without arguments, as <code>par</code>, it will give you a full list of the current defaults, if you want to query only one or a few parameters use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="st">&quot;lwd&quot;</span>)          ## see current line width</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;lwd&quot;</span>,<span class="st">&quot;pch&quot;</span>)) ## see lwd and plotting symbols</code></pre></div>
<pre><code>## $lwd
## [1] 1
## 
## $pch
## [1] 1</code></pre>
<p>to change the value of a parameter you can use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">lwd=</span><span class="fl">1.4</span>)       ## change line width
<span class="kw">par</span>(<span class="dt">pch=</span><span class="st">&quot;*&quot;</span>,       ## change plotting symbol
    <span class="dt">bg =</span><span class="st">&quot;gray80&quot;</span>)  ## use a light gray background</code></pre></div>
<p>Moreover most plotting functions like <code>plot</code>, <code>barplot</code> and so on, allow you to set some of the parameters for the current plot, as an argument to the function itself, for example in <code>plot</code> you can choose the type of plot (points vs lines) and the plotting symbol as options with <code>type</code> and <code>pch</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>,<span class="dv">4</span>,<span class="dv">2</span>)
e =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>,<span class="dv">9</span>,<span class="dv">3</span>)
<span class="kw">plot</span>(d<span class="op">~</span>e, <span class="dt">type=</span><span class="st">&quot;p&quot;</span>, <span class="dt">pch=</span><span class="dv">3</span>)</code></pre></div>
<p>The following sections will give a more in depth explanation of some graphics parameters, before that however we’ll have a closer look at how to use <code>par</code>.</p>
<div id="saving-and-restoring-graphics-parameters" class="section level4">
<h4><span class="header-section-number">8.9.0.1</span> Saving and Restoring Graphics Parameters</h4>
<p>Often you’ll want to change the graphics parameters only for a few plots, and then reset them back to the defaults. The function <code>par</code> when used to change the value of some graphics parameters returns a list with the <em>old</em> values of the graphics parameters that have changed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="st">&quot;lwd&quot;</span>, <span class="st">&quot;col&quot;</span>) <span class="co">#these are the default parameters</span></code></pre></div>
<pre><code>## $lwd
## [1] 1
## 
## $col
## [1] &quot;black&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oldpar =<span class="st"> </span><span class="kw">par</span>(<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#while changing the parameters</span>
                                <span class="co">#we store the old values in a list</span>
oldpar</code></pre></div>
<pre><code>## $lwd
## [1] 1
## 
## $col
## [1] &quot;black&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.1</span>) 
<span class="kw">plot</span>(s, <span class="kw">sin</span>(s))           <span class="co">#we plot something</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(oldpar)              <span class="co"># and then we restore the old parameters</span></code></pre></div>
<p>notice that calling <code>par</code>, opens a graphics device if there is not one already open, the changes you do using <code>par</code> apply only to this graphics device, any other new graphic device that you open will have the default graphics parameters.</p>
</div>
<div id="list-of-graphics-parameters-by-category" class="section level4">
<h4><span class="header-section-number">8.9.0.2</span> List of Graphics Parameters by Category</h4>
<table>
<caption><span id="tab:parcolours">Table 8.2: </span> Parameters for colours.</caption>
<thead>
<tr class="header">
<th>Parameter</th>
<th align="left">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>col</code></td>
<td align="left">plotting colour</td>
</tr>
<tr class="even">
<td><code>col.axis</code></td>
<td align="left">colour for axis annotation</td>
</tr>
<tr class="odd">
<td><code>col.lab</code></td>
<td align="left">colour for x and y labels</td>
</tr>
<tr class="even">
<td><code>col.main</code></td>
<td align="left">colour for main title</td>
</tr>
<tr class="odd">
<td><code>col.sub</code></td>
<td align="left">colour for sub-titles</td>
</tr>
<tr class="even">
<td><code>bg</code></td>
<td align="left">background colour</td>
</tr>
<tr class="odd">
<td><code>fg</code></td>
<td align="left">foreground colour</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:parfonts">Table 8.3: </span> Parameters for fonts.</caption>
<thead>
<tr class="header">
<th>Parameter</th>
<th align="left">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>family</code></td>
<td align="left">font family (e.g. “sans”, “serif”, “mono”)</td>
</tr>
<tr class="even">
<td><code>font</code></td>
<td align="left">font type for text (1=plain, 2=bold, 3=italic etc…)</td>
</tr>
<tr class="odd">
<td><code>font.axis</code></td>
<td align="left">font type for axis annotation (1=plain, 2=bold, 3=italic etc…)</td>
</tr>
<tr class="even">
<td><code>font.lab</code></td>
<td align="left">font type for x and y labels (1=plain, 2=bold, 3=italic etc…)</td>
</tr>
<tr class="odd">
<td><code>font.main</code></td>
<td align="left">font type for main titles (1=plain, 2=bold, 3=italic etc…)</td>
</tr>
<tr class="even">
<td><code>font.sub</code></td>
<td align="left">font type for sub titles (1=plain, 2=bold, 3=italic etc…)</td>
</tr>
<tr class="odd">
<td><code>ps</code></td>
<td align="left">point size of text</td>
</tr>
</tbody>
</table>
</div>
<div id="lty" class="section level3">
<h3><span class="header-section-number">8.9.1</span> Line type with the <code>lty</code> parameter</h3>
<p>There are six line types that you can call in R just with names or numbers (actually there are seven, the first one is “blank” or 0 which just draws nothing). These are listed in Table <a href="graphics.html#tab:lty">8.4</a> and shown in Figure <a href="graphics.html#fig:lty">8.11</a>. There is a different, more complicated way for setting many more line types, please, consult the manual for further information on that.</p>
<table>
<caption><span id="tab:lty">Table 8.4: </span> The six default line types in R.</caption>
<thead>
<tr class="header">
<th>No.</th>
<th align="left">Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">solid</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">dashed</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left">dotted</td>
</tr>
<tr class="even">
<td>4</td>
<td align="left">dotdash</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="left">longdash</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">twodash</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:lty"></span>
<img src="graphics_par_files/figure-html/lty-1.png" alt="The six default line types in R" width="576" />
<p class="caption">
Figure 8.11: The six default line types in R
</p>
</div>
</div>
<div id="secpch" class="section level3">
<h3><span class="header-section-number">8.9.2</span> Symbols with the <code>pch</code> parameter</h3>
<p><code>pch</code> is a graphical parameter for changing the way points are plotted in certain graphical functions. This parameter can be set in two ways, the first one is to give a symbol to be plotted as a character, for example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pch=<span class="st">&quot;+&quot;</span>
pch=<span class="st">&quot;T&quot;</span>
pch=<span class="st">&quot;*&quot;</span>
pch=<span class="st">&quot;3&quot;</span> </code></pre></div>
<p>in this case you enclose the character you want to use between quotes, you can’t use more than a single character. The other way to set the <code>pch</code> is to use a number between 0 and 25, which will select one of 26 special symbols available for plotting (see Figure <a href="graphics.html#fig:pch">8.12</a>), like circles, triangles, and so on:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pch=<span class="dv">1</span>
pch=<span class="dv">3</span>
pch=<span class="dv">5</span></code></pre></div>
<div class="figure"><span id="fig:pch"></span>
<img src="graphics_par_files/figure-html/pch-1.png" alt="Plotting symbols from 0 to 25" width="576" />
<p class="caption">
Figure 8.12: Plotting symbols from 0 to 25
</p>
</div>
</div>
<div id="fonts" class="section level3">
<h3><span class="header-section-number">8.9.3</span> Fonts</h3>
<p>The interface for setting font parameters for plots in R is somehow complex and I have a limited knowledge of how it works. I nonetheless hope that the notes below can be of some use to other people.</p>
<p>One of the reasons why setting font parameters can be confusing is that font parameters can be affected by several graphics parameters. For example the graphics parameter <code>ps</code> sets the point size of the font, but this size can be scaled by the <code>cex</code> parameter. Also font parameters can be set not only using the <code>par</code> interface, but directly when opening a graphics device, and these two ways of setting font parameters can have subtle differences. For example, the font point size can be set by using the <code>pointsize</code> argument when opening a <code>pdf</code> device:</p>
<p>this changes the size of both the font and the plotting symbols. The graphics parameter <code>ps</code>, however, changes only the size of the font:</p>
<p>the documentation for the graphics parameter <code>ps</code> also says that “unlike the pointsize argument of most devices, this does not change the relationship between <code>mar</code> and <code>mai</code> (nor <code>oma</code> and <code>omi</code>).”. I’m not sure what this means, but just be aware setting <code>ps</code> with a call to <code>par</code> or setting <code>pointsize</code> when opening a graphics device are not equivalent. Also, note that if you set the font size when you open a graphics device, the setting may be overridden by subsequent calls to <code>par</code>:</p>
<p><code>cex</code> also overrides the graphics device settings:</p>
<p>The <code>par</code> setting <code>family</code> can be used to choose a serif, sans serif, or mono font:</p>
<div class="figure"><span id="fig:unnamed-chunk-11"></span>
<img src="graphics_par_files/figure-html/unnamed-chunk-11-1.png" alt="Changing font family" width="576" />
<p class="caption">
Figure 8.13: Changing font family
</p>
</div>
<p>however, specifying the exact font used is more complicated. One way to do this is by using the <code>extrafont</code> package <a href="https://cran.r-project.org/web/packages/extrafont/README.html" class="uri">https://cran.r-project.org/web/packages/extrafont/README.html</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
n=<span class="dv">100</span>
dat=<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rnorm</span>(n), <span class="dt">y=</span><span class="kw">rnorm</span>(n))
p =<span class="st"> </span><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;X-Label&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Y-Label&quot;</span>)
p =<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>, <span class="dt">family=</span><span class="st">&quot;Ubuntu&quot;</span>))
## NOT RUN
##ggsave(&quot;cairo_pdf_graphic.pdf&quot;, p, width=3.4, height=3.4, device=cairo_pdf)</code></pre></div>
<p>System fonts in pdf files can be used with the <code>cairo_pdf</code> device; this has the additional advantage of directly embedding the fonts in the pdf. For R base graphics you can invoke <code>cairo_pdf()</code> instead of <code>pdf()</code>. For <code>ggplot2</code>, when you invoke the <code>ggsave</code> function you can pass the argument <code>device=cairo_pdf</code> to use the <code>cairo_pdf</code> device.</p>
<p>Changing the font style is easy using the <code>font</code> parameter, a value of 1 corresponds to a normal (or plain) style, 2 to bold, 3 to italics, 4 to bold italics, and 5 will map the font to a symbol:</p>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="graphics_par_files/figure-html/unnamed-chunk-13-1.png" alt="Changing font style" width="576" />
<p class="caption">
Figure 8.14: Changing font style
</p>
</div>
<p>but note that setting <code>font</code> only changes the font style of plotted text. If you want to change the font style of other textual elements such as the axis labels or the plot title you have to set other graphics parameters:</p>
<div class="figure"><span id="fig:unnamed-chunk-14"></span>
<img src="graphics_par_files/figure-html/unnamed-chunk-14-1.png" alt="Changing font style for other textual elements" width="576" />
<p class="caption">
Figure 8.15: Changing font style for other textual elements
</p>
</div>
</div>
</div>
<div id="adding-elements-to-a-plot" class="section level2">
<h2><span class="header-section-number">8.10</span> Adding Elements to a Plot</h2>
<div id="legend" class="section level3">
<h3><span class="header-section-number">8.10.1</span> Adding a Legend</h3>
<p>Some graphics functions by default add a legend to the graph (e.g. <code>interaction.plot</code>), or allow to add (or remove) a legend by setting an option inside the function (e.g. <code>barplot</code>). However the default settings for the legend, such as positioning, text or symbols, might not be suitable to your graph, in which case you need to turn off the default legend (if there is one), and add a customised legend with the <code>legend</code> function. Below there is an example of an interaction plot with the legend added through the <code>legend</code> function, the resulting graph is in Figure <a href="graphics.html#fig:legend1">8.16</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dats =<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&#39;datasets/direrr_all.txt&#39;</span>, <span class="dt">header=</span>T)
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">1</span>] =<span class="st"> &#39;c - congruent&#39;</span>
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">2</span>] =<span class="st"> &#39;a - inc. goal-directed&#39;</span>
<span class="kw">levels</span>(dats<span class="op">$</span>congr)[<span class="dv">3</span>] =<span class="st"> &#39;b - inc. no-goal-directed&#39;</span>
<span class="kw">interaction.plot</span>(dats<span class="op">$</span>SOA,dats<span class="op">$</span>congr,dats<span class="op">$</span>errors,
   <span class="dt">ylab=</span><span class="st">&#39;Mean proportion of directional errors&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;SOA&#39;</span>,
   <span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">17</span>),<span class="dt">legend=</span><span class="ot">FALSE</span>) ## eliminate default legend
<span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;a - congruent&#39;</span>,<span class="st">&#39;b - inc. goal-directed&#39;</span>,
   <span class="st">&#39;c - inc. no-goal-directed&#39;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">17</span>),
   <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>, <span class="dt">title=</span><span class="st">&#39;Congruency&#39;</span>)</code></pre></div>
<div class="figure"><span id="fig:legend1"></span>
<img src="graphics_par_files/figure-html/legend1-1.png" alt="Plot with &quot;manually&quot; added legend" width="576" />
<p class="caption">
Figure 8.16: Plot with “manually” added legend
</p>
</div>
<p>here we first generated the plot, and afterwards we added the legend. The first argument, <code>topright</code> indicates the position where we want the legend to appear, other possible values are <code>bottomright</code>, <code>bottomleft</code>, <code>right</code>, <code>bottom</code>, <code>center</code> and so on. It is also possible to specify the position of the legend by giving the coordinates of its top-left corner, for the above example we might have written:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">2.3</span>, <span class="dt">y=</span><span class="fl">0.2</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;a - congruent&#39;</span>,<span class="st">&#39;b - inc. goal-directed&#39;</span>,
   ....example not continued</code></pre></div>
<p>The text of the legend is given as a character vector, each element of the vector represents one item of the legend.</p>
<p>Since we’re using both different line types, and different symbols to differentiate the lines in the interaction plot, for the legend we need to specify both in the legend, with the <code>lty</code>, and <code>pch</code> arguments, the line types and symbols of course, should be the same as those used for the plot.</p>
<p>In the above example we suppressed the drawing of a box around the legend setting the <code>bty</code> argument to <code>n</code>, if you want a box set it to <code>o</code> (this is the default anyway, so you don’t really need to specify it if you want the box). If you choose to enclose the legend into a box, you can set its background colour through the <code>bg</code> argument.</p>
<p>There are of course many other options, to get a full listing, please look up the manual.</p>
</div>
<div id="adding-text" class="section level3">
<h3><span class="header-section-number">8.10.2</span> Adding Text</h3>
<p>You can insert text in a graph with the <code>text</code> function, you have just to specify the x and y coordinates of the point on which to center the text:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, y)
<span class="kw">text</span>(<span class="dt">x=</span><span class="dv">3</span>,<span class="dt">y=</span><span class="fl">1.5</span>, <span class="st">&quot;mean for control group&quot;</span>)</code></pre></div>
<p>if you want to use LaTeX mathematical symbols, you have to use the <code>expression</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">text</span>(<span class="dt">x=</span><span class="dv">3</span>, <span class="dt">y=</span><span class="fl">1.5</span>, <span class="kw">expression</span>(alpha))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dpText =<span class="st"> </span><span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;d&#39;&quot;</span>))
uVtext =<span class="st"> </span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&#39;Amplitude (&#39;</span>, mu, <span class="st">&#39;V)&#39;</span>))
deltaEText =<span class="st"> </span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&#39;Change&#39;</span>, Delta, <span class="st">&#39;E&#39;</span>))
reLevText =<span class="st"> </span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&#39;Level &#39;</span>, <span class="kw">italic</span>(<span class="st">&#39;re.&#39;</span>), <span class="st">&#39; 1 &#39;</span>, mu, V<span class="op">^</span>{<span class="dv">2</span>}, <span class="st">&#39; (dB)&#39;</span>))</code></pre></div>
</div>
<div id="addgrid" class="section level3">
<h3><span class="header-section-number">8.10.3</span> Adding a Grid</h3>
<p>A grid can be easily added to an existing plot with the function <code>grid</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">2</span><span class="op">*</span>pi, <span class="dt">length=</span><span class="dv">100</span>)
<span class="kw">plot</span>(s, <span class="kw">sin</span>(s))
<span class="kw">plot</span>(s, <span class="kw">sin</span>(s), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)
<span class="kw">grid</span>() ##add the grid</code></pre></div>
<p>The default colour for the grid is lightgray, you can choose another colour setting the <code>col</code> option:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid</span>(<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
</div>
<div id="axes" class="section level3">
<h3><span class="header-section-number">8.10.4</span> Setting the Axes</h3>
<p>If you don’t like the way the axes are set for a given plot, you can draw the plot without them first, and then add customised axes with the `axis+ function. There are several ways to get rid of the default axes on a plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>) <span class="co">#do not draw any axes or box around</span>
                       <span class="co"># the plot</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>)       <span class="co">#don&#39;t draw the x axis alone</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)       <span class="co">#don&#39;t draw the y axis alone</span></code></pre></div>
<p>Once you’ve removed of one or more axis you can draw them calling the <code>axis</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">3</span>), <span class="dt">labels=</span><span class="kw">as.character</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">3</span>)))</code></pre></div>
<p>the first argument specifies the side on which the axis should be drawn, 1 means the bottom axis, 2 the left axis, 3 the top axis, and 4 the right axis. See <code>?axis</code> for other arguments to the function.</p>
</div>
</div>
<div id="creating-layouts-for-multiple-graphs-glayout" class="section level2">
<h2><span class="header-section-number">8.11</span> Creating Layouts for Multiple Graphs {glayout}</h2>
<div id="mfrow-and-mfcol-mfrowmfcol" class="section level3">
<h3><span class="header-section-number">8.11.1</span> mfrow and mfcol {mfrowmfcol}</h3>
<p>The parameters <code>mfrow</code> and <code>mfcol</code> allow you to divide the graphics device you’re using (e.g. <code>X11</code> or <code>pdf</code>) into multiple boxes, each box will contain a new figure. These parameters are set giving a vector of the form:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(n_rows,n_columns))</code></pre></div>
<p>where <code>n_rows</code> is the number of rows and <code>n_columns</code> is the number of columns you want for your layout. For example, the following will create a layout with 2 rows and 3 columns as you can see in Figure <a href="graphics.html#fig:mfrow23">8.17</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
symb &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){
    <span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">pch=</span>symb[i], <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;&#39;</span>)
} </code></pre></div>
<div class="figure"><span id="fig:mfrow23"></span>
<img src="graphics_par_files/figure-html/mfrow23-1.png" alt="A 2x3 Layout with `mfrow`" width="576" />
<p class="caption">
Figure 8.17: A 2x3 Layout with <code>mfrow</code>
</p>
</div>
<p><code>mfcol</code> works exactly the same way as <code>mfrow</code>, but the figures are drawn in sequence by column rather than by row, for example the following code yields the Figure <a href="graphics.html#fig:mfcol23">8.18</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
symb&lt;-<span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){
  <span class="kw">plot</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dt">pch=</span>symb[i],<span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;&#39;</span>)
} </code></pre></div>
<div class="figure"><span id="fig:mfcol23"></span>
<img src="graphics_par_files/figure-html/mfcol23-1.png" alt="A 2x3 Layout with `mfcol`" width="576" />
<p class="caption">
Figure 8.18: A 2x3 Layout with <code>mfcol</code>
</p>
</div>
<p>of course you can get other layouts, try:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) ## 4 boxes
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) ## one row, 3 cols</code></pre></div>
<p>Rather than having the figures drawn sequentially, following the order determined by <code>mfrow</code> or <code>mfcol</code>, it is possible to specify directly the position for the next figure using the <code>mfg</code> parameter. The next example will draw the plot in the slot defined by the crossing between the second row and the first column of a 2x2 layout:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) ##create 2x2 layout
<span class="kw">par</span>(<span class="dt">mfg=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))   ##set next fig at 2dn row, 1st col
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw">sin</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>))</code></pre></div>
</div>
<div id="layout" class="section level3">
<h3><span class="header-section-number">8.11.2</span> layout</h3>
<p>A more flexible way to divide a graphics device into multiple plotting regions is given by the <code>layout</code> function. With the <code>layout</code> function, the graphics device is divided into a matrix of <em>n_rows x n_cols</em> sub-regions, and each figure is assigned to one or more of these sub-regions. Let’s look at an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
m</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(m)</code></pre></div>
<p>the matrix <code>m</code> we’ve created, completely defines our layout for the graphics window. The window is divided into 2 x 2=4 sub-regions. Moreover, the first figure is assigned the sub-region on the top-left of the window, the second figure the sub-region at the top-right, the third the region at the bottom-left, and the fourth the region at the bottom-right. This example is in itself not very different from what we would get with <code>mfrow</code>, however two key differences make <code>layout</code> more powerful than <code>mfrow</code>. First, it is possible to assign more than a single sub-region to a figure, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
m</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    2    3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(m)</code></pre></div>
<p>divides the graphics window into 4 sub-regions as above, but the first figure is assigned the two sub-regions on top, while the bottom-left sub-region is assigned to the second figure, and the bottom-right to the third.</p>
<p>The second key difference with <code>mfrow</code> is that with <code>layout</code> it is possible to define the width of the columns, and the height of the rows composing the array of sub-regions in the graphics window. Width and height are given as vectors of <em>relative</em> widths and heights. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
m</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    2    3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(m, <span class="dt">width=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>), <span class="dt">height=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</code></pre></div>
<p>will make the first column 1/4 of the total width, and the second column the other 3/4, the same reasoning applies to the row heights. The command <code>layout.show(n)</code>, where <code>n</code> is the number of <span class="math inline">\(n^{th}\)</span> figure that is going to be plotted, will show the outline of its layout in the graphics window.</p>
</div>
</div>
<div id="graphics-device-regions-and-coordinates" class="section level2">
<h2><span class="header-section-number">8.12</span> Graphics Device Regions and Coordinates</h2>
<p>In traditional R graphics the graphics device (e.g. the <code>X11</code> window where your plot and annotations appear) is divided into different regions (see Figure <a href="graphics.html#fig:figureregion">8.19</a>):</p>
<ul>
<li>the <em>plotting region</em> is the area in which the drawing of points or lines representing your data occur. The plotting region is contained into the <em>figure region</em></li>
<li>the <em>figure region</em> is composed of the plotting regions plus the margins where the plot can be annotated with labels for the axes, a title etc…</li>
<li>the <em>outer margins</em> surround the figure regions. The outer margins are usually set to zero (i.e. there are no outer margins), they become useful however for annotating multiple plots that appear on the same page (e.g.~plots generated with `mfrow+). When multiple plots are arranged on the same page (or device), each is assigned a <em>figure region</em> with its own margins, so the outer margins can be used for annotating the overall page (see Figure <a href="graphics.html#fig:figureregionsubplot">8.20</a>).</li>
</ul>
<div class="figure"><span id="fig:figureregion"></span>
<img src="graphics_par_files/figure-html/figureregion-1.png" alt="The figure region includes the plotting region and the margins" width="576" />
<p class="caption">
Figure 8.19: The figure region includes the plotting region and the margins
</p>
</div>
<div class="figure"><span id="fig:figureregionsubplot"></span>
<img src="graphics_par_files/figure-html/figureregionsubplot-1.png" alt="Device with outer margins and multiple figure regions" width="576" />
<p class="caption">
Figure 8.20: Device with outer margins and multiple figure regions
</p>
</div>
<p>The width and height of the device is usually specified when the device is opened, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">X11</span>(<span class="dt">width=</span><span class="dv">8</span>, <span class="dt">height=</span><span class="dv">8</span>)</code></pre></div>
<p>opens a <code>X11</code> device measuring 8x8 inches. The size of an open device can be queried with <code>par(&quot;din&quot;)</code>, this is a read only graphics parameter, which I guess means that once a certain device is opened its size cannot be changed (an <code>X11</code> window however can be re-sized with the mouse, and <code>par(&quot;din&quot;)</code> correctly reports the new size). Different units of measure can be used to specify the size of the areas inside a device, some of these units will be shortly introduced here, others will be explained when they are first used:</p>
<ul>
<li><em>inches</em>: an inch is 2.54 centimetres (notice that the actual physical measure of what you see on your monitor may depend on your monitor’s settings, e.g. dpi, screen resolution, etc…)</li>
<li><em>lines of text</em>: this measure depends on the value of <code>cex</code> and <code>pointsize</code></li>
<li><em>Normalised Device Coordinates (NDC)</em>: the device region is 1x1 NDC whatever the actual physical measure. The lower left corner has coordinates (x=0, y=0) and the upper right corner (x=1, y=1). Using NDC thus the size of regions inside the device can be specified in relative terms to the device size.</li>
</ul>
<p>In the next paragraphs the graphics parameters for controlling the different regions inside the device will be explained. Always keep in mind the layout of a graphics device in R (see Figure <a href="graphics.html#fig:figureregion">8.19</a> and Figure <a href="graphics.html#fig:figureregionsubplot">8.20</a>).</p>
<div id="figure-region" class="section level4">
<h4><span class="header-section-number">8.12.0.1</span> Figure Region</h4>
<p>The figure region can be set either in inches or in normalised device coordinates.</p>
<ul>
<li><code>fig</code>: NDC coordinates of the device in the form <code>c(x1, x2, y1, y2)</code>, where (x1, y1) are the coordinates of the lower left corner, and (x2, y2) are the coordinates of the upper right corner). Example:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">fig=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="kw">par</span>(<span class="dt">fig=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>)) <span class="co"># the next call to plot will erase the</span>
                             <span class="co"># current plot</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)
<span class="kw">par</span>(<span class="dt">fig=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>), <span class="dt">new=</span><span class="ot">TRUE</span>) <span class="co"># the next call to plot will not </span>
                                       <span class="co"># erase the current plot</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</code></pre></div>
<p>as shown in the example to change the figure region without starting a new plot add <code>new=TRUE</code>, this may be used for creating complex arrangements for multiple plots within the same device.</p>
<ul>
<li><code>fin</code>: the figure region dimension (width, height) in inches. Example:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">fin=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>))</code></pre></div>
</div>
<div id="plotting-region" class="section level4">
<h4><span class="header-section-number">8.12.0.2</span> Plotting Region</h4>
<ul>
<li><code>plt</code>: a vector of the form <code>c(x1, x2, y1, y2)</code> giving the coordinates of the plot region as fractions of the current figure region</li>
<li><code>pin</code>: the current plot dimensions, <code>(width,height)</code>, in inches</li>
</ul>
</div>
<div id="margins" class="section level4">
<h4><span class="header-section-number">8.12.0.3</span> Margins</h4>
<ul>
<li><code>mar</code>: the width of the margins for the four sides of the plot, specified in terms of <em>lines of text</em>. The margins are specified in the form <code>c(bottom, left, top, right)</code>. The default is <code>c(5,4,4,2) + 0.1</code>. Example:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>) <span class="co"># get current margins size</span>
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>) <span class="co">#set new margins size</span></code></pre></div>
<ul>
<li><code>mai</code>: the same as <code>mar</code>, but the unit of measure is inches rather than lines of text</li>
</ul>
</div>
<div id="outer-margins" class="section level4">
<h4><span class="header-section-number">8.12.0.4</span> Outer Margins</h4>
<ul>
<li><code>oma</code>: a vector of the form <code>c(bottom, left, top, right)</code> giving the size of the outer margins in lines of text</li>
<li>A vector of the form <code>c(bottom, left, top, right)</code> giving the size of the outer margins in inches</li>
<li>A vector of the form <code>c(x1, x2, y1, y2)</code> giving the outer margin region in normalised device coordinates (NDC)</li>
</ul>
</div>
</div>
<div id="plotfromscratch" class="section level2">
<h2><span class="header-section-number">8.13</span> Plotting from Scratch</h2>
<p>The high level plotting functions such as <code>plot</code>, <code>histogram</code>, <code>barplot</code> and so on, provide a good and quick way to produce graphs. Plotting from scratch, using the low-level plotting commands is generally not necessary, unless you want to create some new, customised plotting functions. Learning to plot “from scratch”, however is a very good way to learn how graphics parameters work, which is often necessary to customise plots created with the high-level plotting functions.</p>
<p>We’ll start with a very simple example of a scatterplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</code></pre></div>
<p>the <code>plot.new()</code> command creates a frame for plotting, and opens a graphics device if there is not one already opened. <code>plot.window</code> defines the limits for the x and y axes, points outside these limits will not appear in the plot. After these two commands we’re ready to do the actual drawing</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">points</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>), <span class="dt">y=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>))
<span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>)</code></pre></div>
<p><code>points</code> will draw points at the coordinates given in the <code>x</code> an <code>y</code> arguments. To complete this very minimal plot you need at least some axes. The <code>axis</code> function adds the axis, the <code>side</code> argument specifies where the axis should be drawn, 1 means at the “bottom”, 2 at the “left” side, and so on in a clockwise fashion.</p>
</div>
<div id="colours-for-graphics" class="section level2">
<h2><span class="header-section-number">8.14</span> Colours for Graphics</h2>
<p>The command <code>colours</code> gives a list of built-in colours available for graphics in R. You can see some of these colours in Figure <a href="graphics.html#fig:color1">8.21</a>. There are 101 built-in shades of gray, from <code>gray0</code>, that is almost black, to <code>gray100</code> that is almost white, you can see some of them in Figure <a href="graphics.html#fig:gray">8.22</a>. A complete table of built-in R colours is given in Appendix <a href="fullcoltable.html#fullcoltable">D</a>.</p>
<div class="figure"><span id="fig:color1"></span>
<img src="graphics/colours_table.png" alt="Some built-in colours in R." width="289" />
<p class="caption">
Figure 8.21: Some built-in colours in R.
</p>
</div>
<div class="figure"><span id="fig:gray"></span>
<img src="graphics/grays_table.png" alt="Different shades of gray." width="276" />
<p class="caption">
Figure 8.22: Different shades of gray.
</p>
</div>
<p>You can also specify colours in rgb values. By default R accepts values in the range 0-1, but you can change the range with the <code>max</code> option to set the range as 0-255. Please note that changing the range doesn’t change the colours you can use, it just changes the values you use to specify them, so for example the following graphs will have the same colours:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>)
<span class="kw">barplot</span> (vec, <span class="dt">col=</span> <span class="kw">c</span>(<span class="kw">rgb</span>(<span class="fl">0.176</span>, <span class="fl">0.262</span>, <span class="fl">0.49</span>),
         <span class="kw">rgb</span>(<span class="fl">0.568</span>, <span class="fl">0.254</span> <span class="fl">0.654</span>)))
<span class="kw">barplot</span> (vec, <span class="dt">col=</span> <span class="kw">c</span>(<span class="kw">rgb</span>(<span class="dv">45</span>,<span class="dv">67</span>,<span class="dv">125</span>, <span class="dt">max=</span><span class="dv">255</span>),
         <span class="kw">rgb</span>(<span class="dv">145</span>,<span class="dv">65</span>,<span class="dv">167</span>, <span class="dt">max=</span><span class="dv">255</span>)))</code></pre></div>
<p>the first uses the default range, and the second uses the range 0-255, but I simply derived the values for the first graph, dividing those for the second by 255.</p>
<p>The function <code>col2rgb</code> can be used to get the rgb values of a built-in colour from its name. The rgb values are given in this case in the range 0-255. Here’s an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">col2rgb</span>(<span class="st">&quot;lightslateblue&quot;</span>)</code></pre></div>
<pre><code>##       [,1]
## red    132
## green  112
## blue   255</code></pre>
<div id="colour-opacity" class="section level3">
<h3><span class="header-section-number">8.14.1</span> Colour Opacity</h3>
<p>The <code>adjustcolor</code> function can be used to set the opacity of a color using the <code>alpha.f</code> argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mycol =<span class="st"> </span><span class="kw">adjustcolor</span>(<span class="st">&quot;skyblue&quot;</span>, <span class="dt">alpha.f=</span><span class="fl">0.5</span>) 
x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)
y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)
<span class="kw">plot</span>(x, y, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>mycol, <span class="dt">cex=</span><span class="dv">2</span>)</code></pre></div>
<div class="figure"><span id="fig:coltransp"></span>
<img src="graphics_par_files/figure-html/coltransp-1.png" alt="Colour opacity" width="576" />
<p class="caption">
Figure 8.23: Colour opacity
</p>
</div>
<p>the <code>adjustcolor</code> function accepts a vector of colors as an argument, so you can change the transparency of several colours at</p>
</div>
</div>
<div id="managing-graphic-devices" class="section level2">
<h2><span class="header-section-number">8.15</span> Managing Graphic Devices</h2>
<div id="opening-another-graphics-window" class="section level3">
<h3><span class="header-section-number">8.15.1</span> Opening Another Graphics Window</h3>
<p>When you issue the command for a graph R opens a window to show it, if you afterwards issue another command for a graph, if the previous window is still open, R doesn’t open another one, but rather replaces the old graph with the new one. If you wish to show the new graph in a separate window, you have to open the graphic device yourself, this is accomplished with the command <code>X11</code> under Unix and with the command <code>windows</code> under the Windows OS. The device window can also be closed from the command line with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dev.off</span>()</code></pre></div>
<p>if you have many device windows open and you want to close them all at once use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">graphics.off</span>()</code></pre></div>
<p>For further functions to manage multiple device windows see <code>?dev.set</code>.</p>
</div>
<div id="exporting-graphics" class="section level3">
<h3><span class="header-section-number">8.15.2</span> Exporting Graphics</h3>
<p>With R it’s also possible to export your graphics in different file formats, such as JPEG or postscript files. To do this, you need to open first the graphics device you want to use, then insert the command for the graphic, and finally turn off the graphic device. Here’s an example of how to produce a graphic in JPEG format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">jpeg</span>(<span class="dt">file=</span><span class="st">&quot;plot.jpeg&quot;</span>)
<span class="kw">plot</span>(x,y)
<span class="kw">dev.off</span>()</code></pre></div>
<p>Other devices you can use, with their corresponding file format are <code>pdf</code>, <code>postscript</code>, <code>png</code> and <code>bitmap</code>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sam81/rguide/edit/master/graphics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rguide.pdf", "rguide.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
